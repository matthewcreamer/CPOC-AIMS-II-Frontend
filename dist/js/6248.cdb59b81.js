"use strict";(self["webpackChunktims_dexon"]=self["webpackChunktims_dexon"]||[]).push([[6248],{30594:(t,e,a)=>{a.d(e,{Z:()=>d});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-content-loading"},[a("div",{staticClass:"box"},[a("hash-loader",{staticClass:"custom-class",attrs:{color:"#1e1450",loading:!0,size:40,sizeUnit:"px"}})],1)])},n=[];const o={name:"AppLoading",props:{text:String,icon:String,color:String}},s=o;var l=a(1001),r=(0,l.Z)(s,i,n,!1,null,"cf1f01c2",null);const d=r.exports},96348:(t,e,a)=>{a.d(e,{Z:()=>d});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"image-preview-wrapper"},[a("div",{staticClass:"preview-popup"},[a("v-ons-toolbar-button",{staticClass:"btn-close",on:{click:function(e){return t.CLOSE_PREVIEW()}}},[a("i",{staticClass:"las la-times"})]),a("v-ons-toolbar-button",{staticClass:"btn-close download"},[a("a",{attrs:{target:"_blank",href:t.baseURL+t.imageURL,download:""}},[a("i",{staticClass:"las la-download"})])]),a("img",{attrs:{src:t.baseURL+t.imageURL}})],1)])},n=[];a(74916),a(23123);const o={name:"image-preview",props:{imageURL:String},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{DOWNLOAD_IMG:function(t){var e=document.createElement("a");e.href=t,e.download=t.split("/").pop(),document.body.appendChild(e),e.click(),document.body.removeChild(e)},CLOSE_PREVIEW:function(){this.$emit("close-preview")}}},s=o;var l=a(1001),r=(0,l.Z)(s,i,n,!1,null,"4574c401",null);const d=r.exports},46248:(t,e,a)=>{a.r(e),a.d(e,{default:()=>$});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"tab-wrapper"},[a("vue-tabs-chrome",{attrs:{tabs:t.tabs},model:{value:t.tabCurrent,callback:function(e){t.tabCurrent=e},expression:"tabCurrent"}})],1),"info"==t.tabCurrent?a("div",{staticClass:"page-section info-tab-display"},[a("div",{staticClass:"report-sheet report-sheet-info",staticStyle:{"grid-row":"span 2"}},[a("div",{staticClass:"report-container"},[a("div",{staticClass:"sheet-body",staticStyle:{"grid-template-columns":"50% 50%"}},[t._m(0),t._l(t.generalInfo,(function(e){return a("div",{key:e.desc,staticClass:"form-item"},[a("div",{staticClass:"form-item-label"},[a("label",[t._v(t._s(e.desc))])]),a("div",{staticClass:"form-item-value"},[a("label",[t._v(t._s(e.value))])])])})),t._m(1),t._l(t.visualTestInfo,(function(e){return a("div",{key:e.index,staticClass:"form-item"},[a("div",{staticClass:"form-item-label"},[a("label",[t._v(t._s(e.desc))])]),a("div",{staticClass:"form-item-value"},[a("label",[t._v(t._s(e.value))])])])})),a("div",{staticClass:"form-item",staticStyle:{"grid-column":"span 2","grid-row":"span 2"}},[t._m(2),a("div",{staticClass:"form-item-value",class:{"bg-green-status":"Accept"==this.visualTest.visual_test_result,"bg-red-status":"Reject"==this.visualTest.visual_test_result}},[a("label",[t._v(t._s(this.visualTest.visual_test_result))])])]),t._m(3),t._l(t.loadTestInfo,(function(e){return a("div",{key:e.index,staticClass:"form-item"},[a("div",{staticClass:"form-item-label"},[a("label",[t._v(t._s(e.desc))])]),a("div",{staticClass:"form-item-value"},[a("label",[t._v(t._s(e.value))])])])})),a("div",{staticClass:"form-item",staticStyle:{"grid-column":"span 2","grid-row":"span 2"}},[t._m(4),a("div",{staticClass:"form-item-value",class:{"bg-green-status":"Accept"==this.loadTest.load_test_result,"bg-red-status":"Reject"==this.loadTest.load_test_result}},[a("label",[t._v(t._s(this.loadTest.load_test_result))])])]),t._m(5),t._l(t.mpiInfo,(function(e){return a("div",{key:e.index,staticClass:"form-item"},[a("div",{staticClass:"form-item-label"},[a("label",[t._v(t._s(e.desc))])]),a("div",{staticClass:"form-item-value"},[a("label",[t._v(t._s(e.value))])])])})),a("div",{staticClass:"form-item",staticStyle:{"grid-column":"span 2","grid-row":"span 2"}},[t._m(6),a("div",{staticClass:"form-item-value",class:{"bg-green-status":"Accept"==this.mpi.mpi_result,"bg-red-status":"Reject"==this.mpi.mpi_result}},[a("label",[t._v(t._s(this.mpi.mpi_result))])])])],2)])]),a("div",{staticClass:"report-sheet"},[a("div",{staticClass:"report-container"},[a("div",{staticClass:"sheet-body"},[a("div",[t._m(7),a("div",{staticClass:"form-item-picture-log"},[a("div",{staticClass:"img-box"},[a("div",{staticClass:"btn-panel"},[t.infoLifting.overview_img_path?a("v-ons-toolbar-button",{staticClass:"pic-toolbar-btn",on:{click:function(e){return t.PREVIEW_PIC(t.infoLifting.overview_img_path)}}},[a("i",{staticClass:"las la-eye"})]):t._e(),t.infoLifting.overview_img_path?a("v-ons-toolbar-button",{staticClass:"pic-toolbar-btn",on:{click:function(e){return t.DELETE_PIC(t.infoLifting.overview_img_path,1)}}},[a("i",{staticClass:"las la-trash"})]):t._e(),a("v-ons-toolbar-button",[t.infoLifting.overview_img_path?t._e():a("label",{staticClass:"pic-toolbar-btn",attrs:{for:"pic-upload-btn"}},[a("i",{staticClass:"las la-plus"})])])],1),t.infoLifting.overview_img_path?a("img",{attrs:{src:t.baseURL+t.infoLifting.overview_img_path}}):t._e(),a("input",{ref:"pic_upload_ov",staticStyle:{display:"none"},attrs:{type:"file",id:"pic-upload-btn"},on:{change:function(e){return t.UPLOAD_PIC(1)}}}),a("div",{},[t.infoLifting.overview_img_path?t._e():a("i",{staticClass:"las la-image"}),t.infoLifting.overview_img_path?t._e():a("label",[t._v("No Image")])])])])])])])]),a("div",{staticClass:"report-sheet"},[a("div",{staticClass:"report-container"},[a("div",{staticClass:"sheet-body"},[a("div",[t._m(8),a("div",{staticClass:"form-item-picture-log"},[a("div",{staticClass:"img-box"},[a("div",{staticClass:"btn-panel"},[t.infoLifting.name_plate_img_path?a("v-ons-toolbar-button",{staticClass:"pic-toolbar-btn",on:{click:function(e){return t.PREVIEW_PIC(t.infoLifting.name_plate_img_path)}}},[a("i",{staticClass:"las la-eye"})]):t._e(),t.infoLifting.name_plate_img_path?a("v-ons-toolbar-button",{staticClass:"pic-toolbar-btn",on:{click:function(e){return t.DELETE_PIC(t.infoLifting.name_plate_img_path,2)}}},[a("i",{staticClass:"las la-trash"})]):t._e(),t.infoLifting.name_plate_img_path?t._e():a("v-ons-toolbar-button",[t.infoLifting.name_plate_img_path?t._e():a("label",{staticClass:"pic-toolbar-btn",attrs:{for:"pic-upload-btn-2"}},[a("i",{staticClass:"las la-plus"})])])],1),t.infoLifting.name_plate_img_path?a("img",{attrs:{src:t.baseURL+t.infoLifting.name_plate_img_path}}):t._e(),a("input",{ref:"pic_upload_np",staticStyle:{display:"none"},attrs:{type:"file",id:"pic-upload-btn-2"},on:{change:function(e){return t.UPLOAD_PIC(2)}}}),t.infoLifting.name_plate_img_path?t._e():a("i",{staticClass:"las la-image"}),t.infoLifting.name_plate_img_path?t._e():a("label",[t._v("No Image")])])])])])])])]):t._e(),"doc"==t.tabCurrent?a("div",[a("tableGeneralDoc")],1):t._e(),"insp"==t.tabCurrent?a("div",[a("tableInsp")],1):t._e(),"const"==t.tabCurrent?a("div",[a("tableConst")],1):t._e(),1==t.isLoading?a("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e(),t.previewImg?a("previewImage",{attrs:{imageURL:t.previewImg},on:{"close-preview":function(e){return t.PREVIEW_PIC_CLOSE()}}}):t._e()],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label",staticStyle:{"grid-column":"span 2"}},[a("label",[t._v("Lifting information")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label",staticStyle:{"grid-column":"span 2"}},[a("label",[t._v("Latest Visual Test")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-item-label"},[a("label",[t._v("Visual Test Result")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label",staticStyle:{"grid-column":"span 2"}},[a("label",[t._v("Latest Load Test")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-item-label"},[a("label",[t._v("Load Test Result")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label",staticStyle:{"grid-column":"span 2"}},[a("label",[t._v("Latest MPI")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-item-label"},[a("label",[t._v("MPI Result")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label"},[a("label",[t._v("overview picture")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"section-label"},[a("label",[t._v("name plate picture")])])}],o=(a(41539),a(39477)),s=a(17133),l=a.n(s),r=a(25930),d=a.n(r),c=a(30594),u=a(96348),f=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"page-section"},[e._m(0),i("DxDataGrid",{attrs:{id:"const-data-grid","key-expr":"id","data-source":e.library,"element-attr":e.dataGridAttributes,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"focused-row-enabled":!1,"row-alternation-enabled":!1},on:{"row-inserted":e.ADD_NEW_FILE,"row-removed":e.DELETE_DOC,"init-new-row":function(){t.file=[]}},scopedSlots:e._u([{key:"editCellTemplate",fn:function(t){return[i("div",[i("img",{attrs:{src:"http://tmt-solution.com/public/image-empty.png",width:"150",height:"100"}}),i("DxFileUploader",{attrs:{"select-button-text":"Select File","label-text":"","upload-mode":"useForm"},on:{"value-changed":e.VALUE_CHANGE}})],1)]}},{key:"insertCellTemplate",fn:function(){return[i("div",{staticClass:"widget-container"},[i("DxFileUploader",{attrs:{id:"file-uploader",multiple:!1,"upload-mode":"useForm",visible:!0},on:{"value-changed":e.VALUE_CHANGE,uploaded:e.VALUE_CHANGE}})],1)]},proxy:!0}])},[i("DxEditing",{attrs:{"allow-deleting":!0,"allow-adding":!0,"allow-updating":!0,"use-icons":!0,"show-borders":!0,mode:"form"}},[i("DxForm",{attrs:{"label-location":"top"}})],1),i("DxColumn",{attrs:{"data-field":"file",visible:!1,"edit-cell-template":"insertCellTemplate"}}),i("DxColumn",{attrs:{"data-field":"file_name","allow-adding":!0,"allow-editing":!0,caption:"File name","editor-options":e.fileNameInputOptions}}),i("DxColumn",{attrs:{type:"buttons"}},[i("DxButton",{attrs:{name:"image",hint:"download",icon:"download","on-click":e.DOWNLOAD}}),i("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),i("DxHeaderFilter",{attrs:{visible:!0}}),i("DxScrolling",{attrs:{mode:"standard"}}),i("DxSearchPanel",{attrs:{visible:!0}}),i("DxPaging",{attrs:{"page-size":10,"page-index":0}}),i("DxPager",{attrs:{visible:!1,"show-page-size-selector":!0,"allowed-page-sizes":[5,10,"all"],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),i("DxExport",{attrs:{enabled:!1}}),i("DxForm",[i("DxItem")],1)],1)],1)},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-header-toolbar left",staticStyle:{width:"calc(100% - 231px)"}},[a("label",{attrs:{id:"hd"}},[t._v("General Document")])])}],p=(a(68309),a(78417)),g=a(48626);const _={name:"LibraryGeneral",components:{DxDataGrid:g.DxDataGrid,DxEditing:g.DxEditing,DxSearchPanel:g.DxSearchPanel,DxPaging:g.DxPaging,DxPager:g.DxPager,DxScrolling:g.DxScrolling,DxColumn:g.DxColumn,DxExport:g.DxExport,DxItem:g.DxItem,DxForm:g.DxForm,DxButton:g.DxButton,DxHeaderFilter:g.DxHeaderFilter,DxFileUploader:p.DxFileUploader},created:function(){console.clear(),this.FETCH_LIBRARY()},data:function(){return{file:[],library:[],dataGridAttributes:{class:"data-grid-style"},fileNameInputOptions:{placeholder:"Enter file name"}}},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{FETCH_LIBRARY:function(){var t=this;this.isLoading=!0;var e=this.$route.params.id_tag;(0,o.Z)({method:"get",url:"/LiftingLibrary/get-library-by-type?id_tag="+e+"&type=3",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){200==e.status&&(t.library=e.data,t.isLoading=!1)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},ADD_NEW_FILE:function(t){var e,a=this,i=JSON.parse(localStorage.getItem("user")),n=new FormData;if(n.append("id",0),n.append("id_tag",this.$route.params.id_tag),n.append("file_name",null!==(e=t.data.file_name)&&void 0!==e?e:""),n.append("id_type",3),n.append("created_by",i.id),n.append("file",this.file),0==this.file.length)return this.$ons.notification.alert("Please select file").then((function(t){0==t&&a.FETCH_LIBRARY()}));(0,o.Z)({method:"post",url:"/LiftingLibrary",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:n}).then((function(t){console.log(t),201==t.status&&a.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),a.isLoading=!1,a.$ons.notification.alert(t.message,{title:"Add New File failed"}).then((function(t){0==t&&a.FETCH_LIBRARY()}))}))["finally"]((function(){a.isLoading=!1}))},VALUE_CHANGE:function(t){console.log(t.value[0].name);var e=new FileReader;e.readAsDataURL(t.value[0]),e.onload=function(){},this.file=t.value[0]},DOWNLOAD:function(t){var e=this.baseURL+t.row.data.file_path,a=document.createElement("a");a.href=e,a.setAttribute("download",t.row.data.file_name),document.body.appendChild(a),a.click()},DELETE_DOC:function(t){var e=this,a=t.data.id;(0,o.Z)({method:"delete",url:"/LiftingLibrary/"+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(t){204==t.status&&e.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),e.isLoading=!1,e.$ons.notification.alert(t.message,{title:"Delete failed"}).then((function(t){0==t&&e.FETCH_LIBRARY()}))}))["finally"]((function(){e.isLoading=!1}))}}},h=_;var v=a(1001),b=(0,v.Z)(h,f,m,!1,null,"544c87f5",null);const L=b.exports;var D=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"page-section"},[e._m(0),i("DxDataGrid",{attrs:{id:"const-data-grid","key-expr":"id","data-source":e.library,"element-attr":e.dataGridAttributes,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"focused-row-enabled":!1,"row-alternation-enabled":!1},on:{"row-inserted":e.ADD_NEW_FILE,"row-removed":e.DELETE_DOC,"init-new-row":function(){t.file=[]}},scopedSlots:e._u([{key:"editCellTemplate",fn:function(t){return[i("div",[i("img",{attrs:{src:"http://tmt-solution.com/public/image-empty.png",width:"150",height:"100"}}),i("DxFileUploader",{attrs:{"select-button-text":"Select File","label-text":"","upload-mode":"useForm"},on:{"value-changed":e.VALUE_CHANGE}})],1)]}},{key:"insertCellTemplate",fn:function(){return[i("div",{staticClass:"widget-container"},[i("DxFileUploader",{attrs:{id:"file-uploader",multiple:!1,"upload-mode":"useForm",visible:!0},on:{"value-changed":e.VALUE_CHANGE,uploaded:e.VALUE_CHANGE}})],1)]},proxy:!0}])},[i("DxEditing",{attrs:{"allow-deleting":!0,"allow-adding":!0,"allow-updating":!0,"use-icons":!0,"show-borders":!0,mode:"form"}},[i("DxForm",{attrs:{"label-location":"top"}})],1),i("DxColumn",{attrs:{"data-field":"file",visible:!1,"edit-cell-template":"insertCellTemplate"}}),i("DxColumn",{attrs:{"data-field":"file_name","allow-adding":!0,"allow-editing":!0,caption:"File name","editor-options":e.fileNameInputOptions}}),i("DxColumn",{attrs:{type:"buttons"}},[i("DxButton",{attrs:{name:"image",hint:"download",icon:"download","on-click":e.DOWNLOAD}}),i("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),i("DxHeaderFilter",{attrs:{visible:!0}}),i("DxScrolling",{attrs:{mode:"standard"}}),i("DxSearchPanel",{attrs:{visible:!0}}),i("DxPaging",{attrs:{"page-size":10,"page-index":0}}),i("DxPager",{attrs:{visible:!1,"show-page-size-selector":!0,"allowed-page-sizes":[5,10,"all"],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),i("DxExport",{attrs:{enabled:!1}}),i("DxForm",[i("DxItem")],1)],1)],1)},C=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-header-toolbar left",staticStyle:{width:"calc(100% - 231px)"}},[a("label",{attrs:{id:"hd"}},[t._v("Construction Document")])])}];const x={name:"LibraryConstruction",components:{DxDataGrid:g.DxDataGrid,DxEditing:g.DxEditing,DxSearchPanel:g.DxSearchPanel,DxPaging:g.DxPaging,DxPager:g.DxPager,DxScrolling:g.DxScrolling,DxColumn:g.DxColumn,DxExport:g.DxExport,DxItem:g.DxItem,DxForm:g.DxForm,DxButton:g.DxButton,DxHeaderFilter:g.DxHeaderFilter,DxFileUploader:p.DxFileUploader},created:function(){console.clear(),this.FETCH_LIBRARY()},data:function(){return{file:[],library:[],dataGridAttributes:{class:"data-grid-style"},fileNameInputOptions:{placeholder:"Enter file name"}}},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{FETCH_LIBRARY:function(){var t=this;this.isLoading=!0;var e=this.$route.params.id_tag;(0,o.Z)({method:"get",url:"/LiftingLibrary/get-library-by-type?id_tag="+e+"&type=1",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){200==e.status&&(t.library=e.data,t.isLoading=!1)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},ADD_NEW_FILE:function(t){var e,a=this,i=JSON.parse(localStorage.getItem("user")),n=new FormData;if(n.append("id",0),n.append("id_tag",this.$route.params.id_tag),n.append("file_name",null!==(e=t.data.file_name)&&void 0!==e?e:""),n.append("id_type",1),n.append("created_by",i.id),n.append("file",this.file),0==this.file.length)return this.$ons.notification.alert("Please select file").then((function(t){0==t&&a.FETCH_LIBRARY()}));(0,o.Z)({method:"post",url:"/LiftingLibrary",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:n}).then((function(t){console.log(t),201==t.status&&a.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),a.isLoading=!1,a.$ons.notification.alert(t.message,{title:"Add New File failed"}).then((function(t){0==t&&a.FETCH_LIBRARY()}))}))["finally"]((function(){a.isLoading=!1}))},VALUE_CHANGE:function(t){console.log(t.value[0].name);var e=new FileReader;e.readAsDataURL(t.value[0]),e.onload=function(){},this.file=t.value[0]},DOWNLOAD:function(t){var e=this.baseURL+t.row.data.file_path,a=document.createElement("a");a.href=e,a.setAttribute("download",t.row.data.file_name),document.body.appendChild(a),a.click()},DELETE_DOC:function(t){var e=this,a=t.data.id;(0,o.Z)({method:"delete",url:"/LiftingLibrary/"+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(t){204==t.status&&e.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),e.isLoading=!1,e.$ons.notification.alert(t.message,{title:"Delete failed"}).then((function(t){0==t&&e.FETCH_LIBRARY()}))}))["finally"]((function(){e.isLoading=!1}))}}},E=x;var w=(0,v.Z)(E,D,C,!1,null,"460bc67a",null);const y=w.exports;var I=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"page-section"},[e._m(0),i("DxDataGrid",{attrs:{id:"const-data-grid","key-expr":"id","data-source":e.library,"element-attr":e.dataGridAttributes,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"focused-row-enabled":!1,"row-alternation-enabled":!1},on:{"row-inserted":e.ADD_NEW_FILE,"row-removed":e.DELETE_DOC,"init-new-row":function(){t.file=[]}},scopedSlots:e._u([{key:"editCellTemplate",fn:function(t){return[i("div",[i("img",{attrs:{src:"http://tmt-solution.com/public/image-empty.png",width:"150",height:"100"}}),i("DxFileUploader",{attrs:{"select-button-text":"Select File","label-text":"","upload-mode":"useForm"},on:{"value-changed":e.VALUE_CHANGE}})],1)]}},{key:"insertCellTemplate",fn:function(){return[i("div",{staticClass:"widget-container"},[i("DxFileUploader",{attrs:{id:"file-uploader",multiple:!1,"upload-mode":"useForm",visible:!0},on:{"value-changed":e.VALUE_CHANGE,uploaded:e.VALUE_CHANGE}})],1)]},proxy:!0}])},[i("DxEditing",{attrs:{"allow-deleting":!0,"allow-adding":!0,"allow-updating":!0,"use-icons":!0,"show-borders":!0,mode:"form"}},[i("DxForm",{attrs:{"label-location":"top"}})],1),i("DxColumn",{attrs:{"data-field":"file",visible:!1,"edit-cell-template":"insertCellTemplate"}}),i("DxColumn",{attrs:{"data-field":"file_name","allow-adding":!0,"allow-editing":!0,caption:"File name","editor-options":e.fileNameInputOptions}}),i("DxColumn",{attrs:{type:"buttons"}},[i("DxButton",{attrs:{name:"image",hint:"download",icon:"download","on-click":e.DOWNLOAD}}),i("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),i("DxHeaderFilter",{attrs:{visible:!0}}),i("DxScrolling",{attrs:{mode:"standard"}}),i("DxSearchPanel",{attrs:{visible:!0}}),i("DxPaging",{attrs:{"page-size":10,"page-index":0}}),i("DxPager",{attrs:{visible:!1,"show-page-size-selector":!0,"allowed-page-sizes":[5,10,"all"],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),i("DxExport",{attrs:{enabled:!1}}),i("DxForm",[i("DxItem")],1)],1)],1)},T=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-header-toolbar left",staticStyle:{width:"calc(100% - 231px)"}},[a("label",{attrs:{id:"hd"}},[t._v("Inspection Document")])])}];const A={name:"LibraryInspection",components:{DxDataGrid:g.DxDataGrid,DxEditing:g.DxEditing,DxSearchPanel:g.DxSearchPanel,DxPaging:g.DxPaging,DxPager:g.DxPager,DxScrolling:g.DxScrolling,DxColumn:g.DxColumn,DxExport:g.DxExport,DxItem:g.DxItem,DxForm:g.DxForm,DxButton:g.DxButton,DxHeaderFilter:g.DxHeaderFilter,DxFileUploader:p.DxFileUploader},created:function(){console.clear(),this.FETCH_LIBRARY()},data:function(){return{file:[],library:[],dataGridAttributes:{class:"data-grid-style"},fileNameInputOptions:{placeholder:"Enter file name"}}},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{FETCH_LIBRARY:function(){var t=this;this.isLoading=!0;var e=this.$route.params.id_tag;(0,o.Z)({method:"get",url:"/LiftingLibrary/get-library-by-type?id_tag="+e+"&type=2",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){200==e.status&&(t.library=e.data,t.isLoading=!1)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},ADD_NEW_FILE:function(t){var e,a=this,i=JSON.parse(localStorage.getItem("user")),n=new FormData;if(n.append("id",0),n.append("id_tag",this.$route.params.id_tag),n.append("file_name",null!==(e=t.data.file_name)&&void 0!==e?e:""),n.append("id_type",2),n.append("created_by",i.id),n.append("file",this.file),0==this.file.length)return this.$ons.notification.alert("Please select file").then((function(t){0==t&&a.FETCH_LIBRARY()}));(0,o.Z)({method:"post",url:"/LiftingLibrary",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:n}).then((function(t){console.log(t),201==t.status&&a.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),a.isLoading=!1,a.$ons.notification.alert(t.message,{title:"Add New File failed"}).then((function(t){0==t&&a.FETCH_LIBRARY()}))}))["finally"]((function(){a.isLoading=!1}))},VALUE_CHANGE:function(t){console.log(t.value[0].name);var e=new FileReader;e.readAsDataURL(t.value[0]),e.onload=function(){},this.file=t.value[0]},DOWNLOAD:function(t){var e=this.baseURL+t.row.data.file_path,a=document.createElement("a");a.href=e,a.setAttribute("download",t.row.data.file_name),document.body.appendChild(a),a.click()},DELETE_DOC:function(t){var e=this,a=t.data.id;(0,o.Z)({method:"delete",url:"/LiftingLibrary/"+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(t){204==t.status&&e.FETCH_LIBRARY()}))["catch"]((function(t){console.log(t),e.isLoading=!1,e.$ons.notification.alert(t.message,{title:"Delete failed"}).then((function(t){0==t&&e.FETCH_LIBRARY()}))}))["finally"]((function(){e.isLoading=!1}))}}},F=A;var S=(0,v.Z)(F,I,T,!1,null,"a11b6516",null);const R=S.exports,N={name:"LiftingInformation",components:{VueTabsChrome:d(),contentLoading:c.Z,previewImage:u.Z,tableGeneralDoc:L,tableConst:y,tableInsp:R},created:function(){this.$store.commit("UPDATE_CURRENT_PAGENAME",{subpageName:"Lifting Information",subpageInnerName:null}),this.FETCH_INFO(),this.FETCH_LATEST_VISUAL_TEST(),this.FETCH_LATEST_LOAD_TEST(),this.FETCH_LATEST_MPI()},data:function(){return{infoLifting:{},visualTest:{},loadTest:{},mpi:{},file_pic_upload:"",tabCurrent:"info",tabs:[{label:"General Information",key:"info",closable:!1},{label:"Construction",key:"const",closable:!1},{label:"Inspection",key:"insp",closable:!1},{label:"General Documents",key:"doc",closable:!1}],previewImg:"",isLoading:!1}},computed:{generalInfo:function(){var t=[{desc:"Tag No.",value:this.infoLifting.tag_no},{desc:"swl main",value:this.infoLifting.swl_main},{desc:"Serial No.",value:this.infoLifting.serial_no},{desc:"swl aux",value:this.infoLifting.swl_aux},{desc:"Site",value:this.infoLifting.id_site},{desc:"Equipment User",value:this.infoLifting.eq_user},{desc:"Part line",value:this.infoLifting.part_line},{desc:"Equipment Type",value:this.infoLifting.id_eq_type},{desc:"Model",value:this.infoLifting.model},{desc:"Equipment Owner",value:this.infoLifting.eq_owner},{desc:"License Plate No.",value:this.infoLifting.license_plate_no},{desc:"License Plate Province",value:this.infoLifting.license_plate_province}];return t},visualTestInfo:function(){var t=[{desc:"Certificate No.",value:this.visualTest.cert_no},{desc:"Visual Test Date",value:this.visualTest.visual_test_date?l()(this.visualTest.visual_test_date).format("LL"):"N/A"},{desc:"Visual Test By",value:this.visualTest.visual_by},{desc:""}];return t},loadTestInfo:function(){var t=[{desc:"Certificate No.",value:this.loadTest.cert_no},{desc:"Load Test Date",value:this.loadTest.load_test_date?l()(this.loadTest.load_test_date).format("LL"):"N/A"}];return t},mpiInfo:function(){var t=[{desc:"Certificate No.",value:this.mpi.cert_no},{desc:"MPI Date",value:this.mpi.mpi_date?l()(this.mpi.mpi_date).format("LL"):"N/A"}];return t},baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},watch:{$route:{handler:function(){this.FETCH_INFO()}}},methods:{FETCH_INFO:function(){var t=this;console.log("==> FETCH Lifting INFO: "),this.isLoading=!0;var e=this.$route.params.id_tag;(0,o.Z)({method:"get",url:"LiftingInfo/"+e,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(e){200==e.status&&e.data&&(t.infoLifting=e.data,console.log(t.infoLifting))}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},FETCH_LATEST_VISUAL_TEST:function(){var t=this;this.isLoading=!0,(0,o.Z)({method:"get",url:"LiftingTest/get-lifting-last-visual-test?id_tag="+this.$route.params.id_tag,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(e){200==e.status&&e.data&&(t.visualTest=e.data[0])}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},FETCH_LATEST_LOAD_TEST:function(){var t=this;this.isLoading=!0,(0,o.Z)({method:"get",url:"LiftingTest/get-lifting-last-load-test?id_tag="+this.$route.params.id_tag,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(e){200==e.status&&e.data&&(t.loadTest=e.data[0])}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},FETCH_LATEST_MPI:function(){var t=this;this.isLoading=!0,(0,o.Z)({method:"get",url:"LiftingTest/get-lifting-last-mpi?id_tag="+this.$route.params.id_tag,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(e){200==e.status&&e.data&&(t.mpi=e.data[0])}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},UPLOAD_PIC:function(t){var e=this;this.isLoading=!0;var a=this.$route.params.id_tag;if(this.file_pic_upload=1==t?this.$refs.pic_upload_ov.files[0]:this.$refs.pic_upload_np.files[0],this.file_pic_upload&&"image/jpeg"==this.file_pic_upload.type||"image/png"==this.file_pic_upload.type)if(this.file_pic_upload.size<2e7)(0,o.Z)({method:"post",url:"/Lifting/upload-pic",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id:a,file:this.file_pic_upload,type:t}}).then((function(t){200==t.status&&(e.FETCH_INFO(),console.log("==> Lifting INFO IMG UPLOAD: DONE"),e.isLoading=!1)}))["catch"]((function(t){e.isLoading=!1,e.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)}))["finally"]((function(){}));else{this.$ons.notification.alert("File size too large. (20 MB max)");var i=document.getElementById("pic-upload-btn");i.val="",this.isLoading=!1}else{this.$ons.notification.alert("Incorrect filetype. <br/> Only JPEG/PNG file can be uploaded.");var n=document.getElementById("pic-upload-btn");n.val="",this.isLoading=!1}},DELETE_PIC:function(t,e){var a=this;this.$ons.notification.confirm("Confirm delete?").then((function(i){if(1==i){a.isLoading=!0;var n=a.$route.params.id_tag;(0,o.Z)({method:"delete",url:"/Lifting/delete-pic",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id:n,file_path:t,type:e}}).then((function(t){200==t.status&&(a.FETCH_INFO(),console.log("==> Lifting INFO IMG DELETE: DONE"),a.isLoading=!1)}))["catch"]((function(t){a.isLoading=!1,a.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)}))["finally"]((function(){a.FETCH_INFO()}))}}))},PREVIEW_PIC:function(t){t&&(this.previewImg=t)},PREVIEW_PIC_CLOSE:function(){this.previewImg=""}}},P=N;var O=(0,v.Z)(P,i,n,!1,null,"4422443e",null);const $=O.exports}}]);
//# sourceMappingURL=6248.cdb59b81.js.map