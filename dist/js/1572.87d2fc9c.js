"use strict";(self["webpackChunktims_dexon"]=self["webpackChunktims_dexon"]||[]).push([[1572],{71572:(t,e,a)=>{a.r(e),a.d(e,{default:()=>f});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"page-section"},[a("DxDataGrid",{attrs:{id:"data-grid-style","key-expr":"id","data-source":t.inspRecordList,"element-attr":t.dataGridAttributes,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1,"column-hiding-enabled":!0,"word-wrap-enabled":!0},on:{exporting:t.EXPORT_DATA,"row-inserted":t.CREATE_RECORD,"row-updated":t.UPDATE_RECORD,"row-removed":t.DELETE_RECORD}},[a("DxEditing",{attrs:{"allow-updating":!0,"allow-deleting":!0,"allow-adding":!0,"use-icons":!0,mode:"form"}},[a("DxForm",{attrs:{"label-location":"top"}},[a("DxItem",{attrs:{"col-count":2,"col-span":2,"item-type":"group"}},[a("DxItem",{attrs:{"data-field":"inspection_date","col-span":1}}),a("DxItem",{attrs:{"data-field":"project_no","col-span":1}}),a("DxItem",{attrs:{"data-field":"report_no","col-span":1}}),a("DxItem",{attrs:{"data-field":"id_campaign","col-span":1}}),a("DxItem",{attrs:{"data-field":"remark","col-span":2}})],1)],1)],1),a("DxColumn",{attrs:{"data-field":"inspection_date",caption:"Inspection date","data-type":"date",format:"dd MMM yyyy","sort-order":"desc",width:140,"editor-options":t.inspDateInputOptions}},[a("DxRequiredRule")],1),a("DxColumn",{attrs:{"data-field":"id_campaign",caption:"Campaign",width:140}},[a("DxLookup",{attrs:{"data-source":t.campaignList,"value-expr":"id","display-expr":"campaign_desc","editor-options":{dataSource:t.campaignList,valueExpr:"id",displayExpr:"campaign_desc"}}}),a("DxRequiredRule")],1),a("DxColumn",{attrs:{"data-field":"project_no",caption:"Project number",width:140,"editor-options":t.projectNoInputOptions}},[a("DxRequiredRule")],1),a("DxColumn",{attrs:{"data-field":"report_no",caption:"Report number",width:140,"editor-options":t.reportNoInputOptions}}),a("DxColumn",{attrs:{"data-field":"remark",caption:"Remark","editor-options":t.remarkInputOptions}}),a("DxScrolling",{attrs:{mode:"standard"}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxPaging",{attrs:{"page-size":10,"page-index":0}}),a("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),a("DxExport",{attrs:{enabled:!0}})],1)],1)])},n=[],s=(a(41539),a(39477)),i=a(17133),r=a.n(i),c=a(71642),d=a(53706),l=a.n(d),p=a(66262),u=a(60082),g=a(48626);const m={name:"inspection-record",components:{DxDataGrid:g.DxDataGrid,DxLookup:g.DxLookup,DxSearchPanel:g.DxSearchPanel,DxPaging:g.DxPaging,DxPager:g.DxPager,DxScrolling:g.DxScrolling,DxColumn:g.DxColumn,DxExport:g.DxExport,DxForm:g.DxForm,DxItem:u.DxItem,DxEditing:g.DxEditing,DxRequiredRule:g.DxRequiredRule},created:function(){this.$store.commit("UPDATE_CURRENT_PAGENAME",{subpageName:"Inspection Record",subpageInnerName:null}),1==this.$store.state.status.server&&(this.FETCH_MD_CAMPAIGN(),this.FETCH_INSP_RECORD())},data:function(){return{inspRecordList:{},campaignList:[],dataGridAttributes:{class:"data-grid-style"},inspDateInputOptions:{placeholder:"Select date"},projectNoInputOptions:{placeholder:"Enter project no"},campaignInputOptions:{placeholder:"Select campaign"},reportNoInputOptions:{placeholder:"Enter report no"},remarkInputOptions:{placeholder:"Enter remark"}}},computed:{},methods:{EXPORT_DATA:function(t){var e=new c.Workbook,a=e.addWorksheet("Projects");(0,p.d)({worksheet:a,component:t.component}).then((function(){e.xlsx.writeBuffer().then((function(t){l()(new Blob([t],{type:"application/octet-stream"}),"inspection_record.xlsx")}))})),t.cancel=!0},FETCH_INSP_RECORD:function(){var t=this;this.isLoading=!0;var e=this.$route.params.id_tag;(0,s.Z)({method:"get",url:"/PressureVesselInspectionRecord/get-pv-ir-by-id-tag?id_tag="+e,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){console.log("insp record:"),console.log(e),200==e.status&&e.data&&(console.log("success"),t.inspRecordList=e.data,console.log(t.inspRecordList))}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},CREATE_RECORD:function(t){var e=this;t.data.id_tag=this.$route.params.id_tag,t.data.id=0,t.data.is_active=!0,t.data.inspection_date=r()(t.data.inspection_date).format("L"),console.log(t.data),(0,s.Z)({method:"post",url:"/PressureVesselInspectionRecord",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){200==t.status&&(console.log("Inspection  record created!"),e.FETCH_INSP_RECORD())}))["catch"]((function(t){e.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)}))["finally"]((function(){}))},UPDATE_RECORD:function(t){var e=this;t.data.inspection_date=r()(t.data.inspection_date).format("L"),console.log(t.data),(0,s.Z)({method:"put",url:"/PressureVesselInspectionRecord/"+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){200==t.status&&(console.log("update success"),e.FETCH_INSP_RECORD())}))["catch"]((function(t){e.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)}))["finally"]((function(){}))},DELETE_RECORD:function(t){var e=this;(0,s.Z)({method:"delete",url:"/PressureVesselInspectionRecord/"+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(t){200==t.status&&(console.log("delete success"),e.FETCH_INSP_RECORD())}))["catch"]((function(t){e.$ons.notification.alert(t.code+" "+t.response.status+" "+t.message)}))["finally"]((function(){}))},FETCH_MD_CAMPAIGN:function(){var t=this;this.isLoading=!0,(0,s.Z)({method:"get",url:"/master-data/get-md-campaign-list",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(e){200==e.status&&e.data&&(console.log("fetch campaign success"),t.campaignList=e.data,console.log(t.campaignList))}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))}}},D=m;var h=a(1001),x=(0,h.Z)(D,o,n,!1,null,"32ea69d9",null);const f=x.exports}}]);
//# sourceMappingURL=1572.87d2fc9c.js.map