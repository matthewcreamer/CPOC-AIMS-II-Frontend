"use strict";(self["webpackChunktims_dexon"]=self["webpackChunktims_dexon"]||[]).push([[4211],{30594:(t,a,e)=>{e.d(a,{Z:()=>d});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-content-loading"},[e("div",{staticClass:"box"},[e("hash-loader",{staticClass:"custom-class",attrs:{color:"#1e1450",loading:!0,size:40,sizeUnit:"px"}})],1)])},i=[];const o={name:"AppLoading",props:{text:String,icon:String,color:String}},s=o;var r=e(1001),l=(0,r.Z)(s,n,i,!1,null,"cf1f01c2",null);const d=l.exports},74211:(t,a,e)=>{e.r(a),e.d(a,{default:()=>v});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-container"},[e("div",{staticClass:"tab-wrapper"},[e("vue-tabs-chrome",{attrs:{tabs:t.tabs},model:{value:t.tabCurrent,callback:function(a){t.tabCurrent=a},expression:"tabCurrent"}})],1),"A1"==t.tabCurrent?e("div",{staticClass:"page-section"},[t._m(0),e("div",{staticClass:"table-wrapper"},[e("DxDataGrid",{attrs:{id:"view-grid","key-expr":"id_thk","element-attr":t.dataGridAttributes,"data-source":t.dataList.view,"focused-row-enabled":!1,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1,"word-wrap-enabled":!0}},[e("DxFilterRow",{attrs:{visible:!0}}),e("DxHeaderFilter",{attrs:{visible:!0}}),e("DxColumn",{attrs:{"data-field":"annular_no",caption:"Plate No.","sort-order":"asc"}}),e("DxColumn",{attrs:{"data-field":"annular_row",caption:"Row"}}),e("DxColumn",{attrs:{"data-field":"annular_column",caption:"Column"}}),e("DxColumn",{attrs:{"data-field":"tp_name",caption:"TP name"}}),e("DxColumn",{attrs:{"data-field":"inservice_date",caption:"In-service date","data-type":"date",format:"dd MMM yyyy"}}),e("DxColumn",{attrs:{"data-field":"t_nom",caption:"tnom (mm)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"t_req",caption:"treq (mm)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"first_insp_date",caption:"First date","data-type":"date",format:"dd MMM yyyy"}}),e("DxColumn",{attrs:{"data-field":"first_t_actual",caption:"First thickness (mm)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"previous_insp_date",caption:"Previous date","data-type":"date",format:"dd MMM yyyy"}}),e("DxColumn",{attrs:{"data-field":"previous_t_actual",caption:"Previous thickness (mm)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"inspection_date",caption:"Last date","data-type":"date",format:"dd MMM yyyy"}}),e("DxColumn",{attrs:{"data-field":"t_actual",caption:"Last thickness (mm)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"crs",caption:"ST_CR (mm/yr)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"crl",caption:"LT_CR (mm/yr)",format:"#,##0.00"}}),e("DxColumn",{attrs:{"data-field":"rl",caption:"RL (yrs)",format:"#,##0.00"}}),e("DxScrolling",{attrs:{mode:"standard"}}),e("DxSearchPanel",{attrs:{visible:!1}}),e("DxPaging",{attrs:{"page-size":10,"page-index":0}}),e("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),e("DxExport",{attrs:{enabled:!0}})],1)],1)]):t._e(),"A2"==t.tabCurrent?e("div",{staticClass:"page-section overflow-x",attrs:{id:"x-page"}},[e("div",{staticClass:"table-wrapper"},[e("div",{staticClass:"table-header-toolbar",staticStyle:{width:"calc(100% - 82px)"}},[t._m(1),e("div",{staticClass:"right"},[e("div",{staticClass:"dx-table-style"},[e("div",{staticClass:"table-toolbar-set"},[e("div",{staticClass:"download-btn"},[e("v-ons-toolbar-button",{attrs:{id:"toolbarBTN"},on:{click:function(a){return t.FETCH_FILE_CML()}}},[e("label",[t._v("Download")])])],1),e("v-ons-toolbar-button",[e("label",{attrs:{for:"cml-upload-btn"}},[e("i",{staticClass:"las la-file-import"}),t._v("Import Excel ")])])],1)])])]),e("input",{ref:"cml_upload_file",staticStyle:{display:"none"},attrs:{type:"file",id:"cml-upload-btn"},on:{change:function(a){return t.UPLOAD_CML()}}}),e("DxDataGrid",{attrs:{id:"cml-grid","key-expr":"id_cml","element-attr":t.dataGridAttributes,"data-source":t.dataList.cml,"hover-state-enabled":!0,"focused-row-enabled":!1,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1,"word-wrap-enabled":!0},on:{"row-inserted":t.CREATE_CML,"row-updated":t.UPDATE_CML,"row-removed":t.DELETE_CML,"selection-changed":t.VIEW_TP,"row-click":t.CML_FLAGER}},[e("DxFilterRow",{attrs:{visible:!0}}),e("DxHeaderFilter",{attrs:{visible:!0}}),e("DxSelection",{attrs:{mode:"single"}}),e("DxEditing",{attrs:{"allow-updating":!0,"allow-deleting":!0,"allow-adding":!0,"use-icons":!0,mode:"mode"}}),e("DxColumn",{attrs:{"data-field":"annular_no",caption:"Plate No.","sort-order":"asc","allow-editing":!1,width:80}}),e("DxColumn",{attrs:{"data-field":"annular_row",caption:"Row",width:80}}),e("DxColumn",{attrs:{"data-field":"annular_column",caption:"Column",width:80}}),e("DxColumn",{attrs:{"data-field":"t_nom",caption:"tnom (mm)",format:"#,##0.00",width:80}}),e("DxColumn",{attrs:{"data-field":"t_req",caption:"tretire (mm)",format:"#,##0.00","allow-editing":!1,width:80}}),e("DxColumn",{attrs:{"data-field":"inservice_date",caption:"In-service date","data-type":"date",format:"dd MMM yyyy",width:120}}),e("DxColumn",{attrs:{type:"buttons"}},[e("DxButton",{attrs:{name:"edit",hint:"Edit",icon:"edit"}}),e("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),e("DxScrolling",{attrs:{mode:"standard"}}),e("DxSearchPanel",{attrs:{visible:!1}}),e("DxPaging",{attrs:{"page-size":10,"page-index":0}}),e("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),e("DxExport",{attrs:{enabled:!0}})],1)],1),e("div",{staticClass:"table-wrapper"},[e("div",{staticClass:"table-header-toolbar",style:t.px},[t._m(2),e("div",{staticClass:"right"},[e("div",{staticClass:"dx-table-style"},[e("div",{staticClass:"table-toolbar-set"},[e("div",{staticClass:"download-btn"},[e("v-ons-toolbar-button",{attrs:{id:"toolbarBTN"},on:{click:function(a){return t.FETCH_FILE_ANNULAR()}}},[e("label",{attrs:{for:"tp-download-tp-btn"}},[t._v("Download")])])],1),e("v-ons-toolbar-button",[e("label",{attrs:{for:"tp-upload-btn"}},[e("i",{staticClass:"las la-file-import"}),t._v("Import Excel ")])])],1)])])]),e("input",{ref:"tp_upload_file",staticStyle:{display:"none"},attrs:{type:"file",id:"tp-upload-btn"},on:{change:function(a){return t.UPLOAD_TP()}}}),e("DxDataGrid",{attrs:{id:"tp-grid","key-expr":"id","element-attr":t.dataGridAttributes,"data-source":t.dataList.tp,"focused-row-enabled":!1,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1,"word-wrap-enabled":!0},on:{"row-inserted":t.CREATE_TP,"row-updated":t.UPDATE_TP,"row-removed":t.DELETE_TP,"selection-changed":t.VIEW_THK,"row-click":t.TP_FLAGER}},[e("DxFilterRow",{attrs:{visible:!0}}),e("DxHeaderFilter",{attrs:{visible:!0}}),e("DxSelection",{attrs:{mode:"single"}}),e("DxEditing",{attrs:{"allow-updating":!0,"allow-deleting":!0,"allow-adding":t.SELECTION_CML,"use-icons":!0,mode:"row"}}),e("DxColumn",{attrs:{"data-field":"tp_name",caption:"TP Name",width:100}}),e("DxColumn",{attrs:{"data-field":"tp_desc",caption:"TP Desc",width:200}}),e("DxColumn",{attrs:{type:"buttons"}},[e("DxButton",{attrs:{name:"edit",hint:"Edit",icon:"edit"}}),e("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),e("DxScrolling",{attrs:{mode:"standard"}}),e("DxSearchPanel",{attrs:{visible:!1}}),e("DxPaging",{attrs:{"page-size":10,"page-index":0}}),e("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} i tems)"}}),e("DxExport",{attrs:{enabled:!0}})],1)],1),e("div",{staticClass:"table-wrapper"},[t._m(3),e("DxDataGrid",{attrs:{id:"thk-grid","key-expr":"id","element-attr":t.dataGridAttributes,selection:{mode:"single"},"data-source":t.dataList.thk,"focused-row-enabled":!1,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1,"word-wrap-enabled":!0},on:{"row-inserted":t.CREATE_THK,"row-updated":t.UPDATE_THK,"row-removed":t.DELETE_THK}},[e("DxFilterRow",{attrs:{visible:!0}}),e("DxHeaderFilter",{attrs:{visible:!0}}),e("DxEditing",{attrs:{"allow-updating":!0,"allow-deleting":!0,"allow-adding":t.SELECTION,"use-icons":!0,mode:"row"}}),e("DxColumn",{attrs:{"data-field":"id_inspection_record",caption:"Inspection date",width:150}},[e("DxLookup",{attrs:{"data-source":t.inspRecordList,"display-expr":t.SET_FORMAT_DATE,"value-expr":"id_inspection_record"}})],1),e("DxColumn",{attrs:{"data-field":"t_actual",caption:"tactual (mm)",format:"#,##0.00",width:150}}),e("DxColumn",{attrs:{type:"buttons"}},[e("DxButton",{attrs:{name:"edit",hint:"Edit",icon:"edit"}}),e("DxButton",{attrs:{name:"delete",hint:"Delete",icon:"trash"}})],1),e("DxScrolling",{attrs:{mode:"standard"}}),e("DxSearchPanel",{attrs:{visible:!1}}),e("DxPaging",{attrs:{"page-size":10,"page-index":0}}),e("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),e("DxExport",{attrs:{enabled:!0}})],1)],1)]):t._e(),"A3"==t.tabCurrent?e("div",{staticClass:"page-container"},[e("div",{staticClass:"page-container-A3",class:[0==t.pagePanelHiding?"page-container-A3":"page-container-hide"]},[e("InspectionRecordPanel",{on:{showHidePanel:t.SHOW_HIDE_PANEL,viewItem:t.VIEW_ITEM}}),this.id_inspection_record?e("div",{staticClass:"list-page"},[e("v-ons-list",[e("v-ons-list-header",[t._v(" Inspection Details of "),e("b",[t._v(t._s(t.DATE_FORMAT(t.current_view.inspection_date)))])])],1),e("div",{staticClass:"table-wrapper"},[e("DxDataGrid",{attrs:{id:"data-grid-style","key-expr":"id","data-source":t.additionalRemarkList,"element-attr":t.dataGridAttributes,"hover-state-enabled":!0,"allow-column-reordering":!0,"show-borders":!0,"show-row-lines":!0,"row-alternation-enabled":!1},on:{"row-inserted":t.CREATE_ADDITIONAL_REMARK,"row-updated":t.UPDATE_ADDITIONAL_REMARK,"row-removed":t.DELETE_ADDITIONAL_REMARK,"editing-start":t.EDITING_START_ADDITIONAL_REMARK,"init-new-row":t.INIT_NEW_ROW_ADDITIONAL_REMARK,saved:t.SAVE},scopedSlots:t._u([{key:"attch_img",fn:function(a){var n=a.data;return[e("div",{staticStyle:{position:"relative"}},[e("a",{attrs:{href:t.baseURL+n.value,download:"dwg",target:"_blank"}},[e("img",{attrs:{src:t.baseURL+n.value,width:"300",height:"200"}}),e("br")])])]}},{key:"attch_img-editor",fn:function(a){var n=a.data;return[e("div",[""!=t.imgHolder&&0==t.isInitEdit?e("img",{attrs:{src:t.baseURL+n.value,width:"300",height:"200"}}):t._e(),""!=t.imgHolder&&1==t.isInitEdit?e("img",{attrs:{src:t.imgHolder,width:"300",height:"200"}}):t._e(),""==t.imgHolder?e("img",{attrs:{src:"http://tmt-solution.com/public/image-empty.png",width:"300",height:"200"}}):t._e(),e("DxFileUploader",{attrs:{"select-button-text":"Select photo","label-text":"",accept:"image/*","upload-mode":"useForm"},on:{"value-changed":t.ON_ATTACHMENT_CHANGE}})],1)]}}],null,!1,1434287500)},[e("DxEditing",{attrs:{"allow-updating":!0,"allow-deleting":!0,"allow-adding":!0,"use-icons":!0,mode:"form"}},[e("DxForm",{attrs:{"label-location":"top"}},[e("DxItem",{attrs:{"col-count":2,"col-span":2,"item-type":"group"}},[e("DxItem",{attrs:{"data-field":"file_path","col-span":2}}),e("DxItem",{attrs:{"data-field":"remark_desc","col-span":2}})],1)],1)],1),e("DxColumn",{attrs:{"data-field":"file_path",caption:"Attachment","cell-template":"attch_img","edit-cell-template":"attch_img-editor",width:400}}),e("DxColumn",{attrs:{"data-field":"remark_desc",caption:"Description","editor-options":t.fileNameInputOptions}}),e("DxSearchPanel",{attrs:{visible:!1}}),e("DxPaging",{attrs:{"page-size":10,"page-index":0}}),e("DxPager",{attrs:{"show-page-size-selector":!0,"allowed-page-sizes":[5,10,20],"show-navigation-buttons":!0,"show-info":!0,"info-text":"Page {0} of {1} ({2} items)"}}),e("DxExport",{attrs:{enabled:!1}})],1)],1)],1):t._e(),""==this.id_inspection_record?e("SelectInspRecord"):t._e()],1)]):t._e(),1==t.isLoading?e("contentLoading",{attrs:{text:"Loading, please wait...",color:"#fc9b21"}}):t._e()],1)},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"table-header-toolbar",staticStyle:{width:"calc(100% - 41px)"}},[e("div",{staticClass:"left"},[e("label",[t._v("Thickness Calculation Result")])]),e("div",{staticClass:"right"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"left"},[e("label",[t._v("CML")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"left"},[e("label",[t._v("TP")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"table-header-toolbar",staticStyle:{width:"calc(100% - 82px)"}},[e("div",{staticClass:"left"},[e("label",[t._v("Thickness")])]),e("div",{staticClass:"right"})])}],o=e(4367),s=(e(41539),e(57327),e(21249),e(91058),e(78783),e(33948),e(60285),e(41637),e(39477)),r=e(17133),l=e.n(r),d=e(30594),c=e(25930),u=e.n(c),p=e(3488),h=e(34556),_=e(78417),g=e(60082),m=e(48626);const f={name:"ViewThicknessBottom",components:{DxForm:m.DxForm,DxItem:g.DxItem,DxFileUploader:_.DxFileUploader,SelectInspRecord:h.Z,InspectionRecordPanel:p.Z,contentLoading:d.Z,DxDataGrid:m.DxDataGrid,DxSearchPanel:m.DxSearchPanel,DxPaging:m.DxPaging,DxPager:m.DxPager,DxScrolling:m.DxScrolling,DxColumn:m.DxColumn,DxExport:m.DxExport,DxEditing:m.DxEditing,DxLookup:m.DxLookup,DxButton:m.DxButton,DxHeaderFilter:m.DxHeaderFilter,DxFilterRow:m.DxFilterRow,DxSelection:m.DxSelection,VueTabsChrome:u()},created:function(){this.$store.commit("UPDATE_CURRENT_INAPP",{name:"Tank Management",icon:"/img/icon_menu/tank/tank.png"}),this.$store.commit("UPDATE_CURRENT_PAGENAME",{subpageName:"Thickness Messurement",subpageInnerName:"Annular"}),1==this.$store.state.status.server&&(this.FETCH_INSP_RECORD(),this.FETCH_CML(),this.FETCH_VIEW())},data:function(){return{pagePanelHiding:!1,current_view:"",id_inspection_record:"",additionalRemarkList:[],imgHolder:"",file:[],isInitEdit:0,dataIMGTemp:"",fileNameInputOptions:{placeholder:"Enter description ..."},px:"width: calc(100% - 41px)",cml_flag:!1,tp_flag:!1,dataList:{cml:[],tp:[],thk:[],view:[]},isLoading:!1,id_cml:0,id_tp:0,inspRecordList:{},dataGridAttributes:{class:"data-grid-style"},tabCurrent:"A2",tabs:[{label:"Calculation Result",key:"A1",closable:!1},{label:"Messurement Result",key:"A2",closable:!1},{label:"Additional Attachment",key:"A3",closable:!1}]}},computed:{SELECTION:function(){return!!this.tp_flag&&(console.warn(this.tp_flag),!0)},SELECTION_CML:function(){return!!this.cml_flag&&(console.warn(this.cml_flag),!0)},baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}},methods:{FETCH_CML:function(){var t=this;this.isLoading=!0;var a=this.$route.params.id_tag;(0,s.Z)({method:"get",url:"TankAnnularThickness/tank-annular-thk-cml-view-by-tag-id?id_tag="+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(a){console.log("cml:"),console.log(a.data),200==a.status&&a.data&&(t.dataList.cml=a.data)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1,t.tp_flag=!1}))},FETCH_TP:function(){var t=this;(0,s.Z)({method:"get",url:"TankAnnularThickness/tank-annular-thk-tp-by-cml-id?id="+this.id_cml,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(a){console.log("tp:"),console.log(a.data),200==a.status&&a.data&&(t.dataList.tp=a.data)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.tp_flag=!1}))},FETCH_THK:function(){var t=this;(0,s.Z)({method:"get",url:"TankAnnularThickness/tank-annular-thk-data-by-tp-id?id="+this.id_tp,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_tp:this.id_tp}}).then((function(a){200==a.status&&a.data&&(t.dataList.thk=a.data)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},FETCH_VIEW:function(){var t=this,a=this.$route.params.id_tag;(0,s.Z)({method:"get",url:"TankAnnularThickness/tank-annular-thk-last-data-view-by-tag-id?id_tag="+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(a){console.log("view:"),console.log(a.data),200==a.status&&a.data&&(t.dataList.view=a.data)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},CREATE_CML:function(t){var a=this;console.log(t);var e=this.$route.params.id_tag;t.data.id_tag=e,t.data.id=0,t.data.inservice_date=l()(t.data.inservice_date).format("L"),t.data.annular_no=t.data.annular_row+"-"+t.data.annular_column,(0,s.Z)({method:"post",url:"TankAnnularThickness/add-tank-annular-thk-cml",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){console.log(t),201==t.status&&t.data&&(a.FETCH_CML(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},UPDATE_CML:function(t){var a=this;t.data.id=t.key,t.data.annular_no=t.data.annular_row+"-"+t.data.annular_column,this.isLoading=!0,(0,s.Z)({method:"put",url:"TankAnnularThickness/edit-tank-annular-thk-cml?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){console.log(t),204==t.status&&(a.FETCH_CML(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},DELETE_CML:function(t){var a=this;console.log(t),this.isLoading=!0,(0,s.Z)({method:"delete",url:"TankAnnularThickness/delete-tank-annular-thk-cml?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(t){console.log(t.data),204==t.status&&(a.FETCH_CML(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},CREATE_TP:function(t){var a=this;t.data.id_cml=this.id_cml,t.data.id=0,console.log(t.data),this.isLoading=!0,(0,s.Z)({method:"post",url:"TankAnnularThickness/add-tank-annular-thk-tp",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){console.log(t),201==t.status&&t.data&&(a.FETCH_TP(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},UPDATE_TP:function(t){var a=this;console.log(t.data),this.isLoading=!0,(0,s.Z)({method:"put",url:"TankAnnularThickness/edit-tank-annular-thk-tp?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){console.log(t),204==t.status&&(a.FETCH_TP(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},DELETE_TP:function(t){var a=this;console.log(t),(0,s.Z)({method:"delete",url:"TankAnnularThickness/delete-tank-annular-thk-tp?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(t){console.log(t.data),204==t.status&&(a.FETCH_TP(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},CREATE_THK:function(t){var a=this;t.data.id=0,t.data.id_tp=this.id_tp,this.isLoading=!0,(0,s.Z)({method:"post",url:"TankAnnularThickness/add-tank-annular-thk-data",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){201==t.status&&t.data&&(a.FETCH_THK(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},UPDATE_THK:function(t){var a=this,e=this.inspRecordList.filter((function(a){return a.id_inspection_record==t.data.id_inspection_record}));t.data.inspection_date=e[0].inspection_date,console.log(t.data),this.isLoading=!0,(0,s.Z)({method:"put",url:"TankAnnularThickness/edit-tank-annular-thk-data?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:t.data}).then((function(t){console.log(t.data),204==t.status&&(a.FETCH_TP(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},DELETE_THK:function(t){var a=this;console.log(t),this.isLoading=!0,(0,s.Z)({method:"delete",url:"TankAnnularThickness/delete-tank-annular-thk-data?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_thk:t.key}}).then((function(t){console.log(t.data),200==t.status&&t.data&&(a.FETCH_THK(),a.FETCH_VIEW())}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},VIEW_TP:function(t){console.log(t),this.id_cml=t.selectedRowKeys[0],this.FETCH_TP(),this.dataList.thk=[],this.tp_flag=!1},VIEW_THK:function(t){console.log(t),this.id_tp=t.selectedRowKeys[0],this.FETCH_THK()},FETCH_INSP_RECORD:function(){var t=this;this.isLoading=!0;var a=this.$route.params.id_tag;(0,s.Z)({method:"get",url:"TankInspectionRecord/get-tank-ir-by-id-tag?id_tag="+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(a){200==a.status&&a.data&&(t.inspRecordList=a.data,t.inspRecordList=t.inspRecordList.map((function(t){return(0,o.Z)((0,o.Z)({},t),{},{id_inspection_record:t.id,id:null})})))}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},SET_FORMAT_DATE:function(t){return l()(t.inspection_date).format("DD MMM yyyy")},UPLOAD_CML:function(){var t=this;this.isLoading=!0;var a=this.$refs.cml_upload_file.files[0],e=parseInt(this.$route.params.id_tag);"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==a.type&&this.$route.params.id_tag?(0,s.Z)({method:"post",url:"/annular-thickness/upload-annular-thk-cml?id_tag="+e,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{file:a}}).then((function(a){console.log(a),204==a.status&&(t.FETCH_CML(),t.FETCH_VIEW())}))["catch"]((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)}))["finally"]((function(){t.isLoading=!1,t.$ons.notification.alert("Upload Completed!")})):this.$ons.notification.alert("Incorrect filetype. <br/> Only XLS/XLSX file can be uploaded.")},UPLOAD_TP:function(){var t=this;this.isLoading=!0;var a=this.$refs.tp_upload_file.files[0],e=parseInt(this.$route.params.id_tag);"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==a.type&&this.$route.params.id_tag?(0,s.Z)({method:"post",url:"/annular-thickness/upload-annular-thk-tp?id_tag="+e,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{file:a}}).then((function(a){console.log(a),204==a.status&&(t.FETCH_TP(),t.FETCH_VIEW())}))["catch"]((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)}))["finally"]((function(){t.isLoading=!1,t.$ons.notification.alert("Upload Completed!")})):this.$ons.notification.alert("Incorrect filetype. <br/> Only XLS/XLSX file can be uploaded.")},TP_FLAGER:function(){this.tp_flag=!0},CML_FLAGER:function(){this.cml_flag=!0,this.px="width: calc(100% - 82px)"},FETCH_FILE_ANNULAR:function(){var t=this;console.log("in");var a=parseInt(this.$route.params.id_tag);(0,s.Z)({method:"get",url:"annular-thickness/download-annular-thk?id_tag="+a,responseType:"blob",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(a){var e=a.data;t.downLoadFileExcel(e,"Annular_TP_TEMPLATE")}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},FETCH_FILE_CML:function(){var t=this;console.log("in");var a=parseInt(this.$route.params.id_tag);(0,s.Z)({method:"get",url:"annular-thickness/download-annular-cml?id_tag="+a,responseType:"blob",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(a){var e=a.data;t.downLoadFileExcel(e,"Annular_CML_TEMPLATE")}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},downLoadFileExcel:function(t,a){console.log(t);var e=document.createElement("a");e.setAttribute("href",window.URL.createObjectURL(new Blob([t]))),e.setAttribute("download",a+".xlsx"),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)},VIEW_ITEM:function(t){this.current_view={},this.current_view=t,this.id_component=this.$route.params.id_component,this.id_inspection_record=t.id_inspection_record,this.FETCH_ADDITIONAL_REMARK()},FETCH_ADDITIONAL_REMARK:function(){var t=this,a=this.id_inspection_record;(0,s.Z)({method:"get",url:"additional-remark/get-additional-remark-by-ir-id-type?id_inspection_record="+a+"&type=annular_thk",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))}}).then((function(a){200==a.status&&(console.warn("FETCH ADDITIONAL"),console.log(a.data),t.additionalRemarkList=a.data)}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},CREATE_ADDITIONAL_REMARK:function(t){var a=this;console.log(t);var e=new FormData,n=JSON.parse(localStorage.getItem("user"));e.append("id_inspection_record",this.id_inspection_record),e.append("id_tag",this.$route.params.id_tag),e.append("remark_type","annular_thk"),e.append("remark_desc",t.data.remark_desc),e.append("file",this.file),e.append("created_by",n.id_account),e.append("updated_by",n.id_account),(0,s.Z)({method:"post",url:"additional-remark/add-additional-remark",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:e}).then((function(t){201==t.status&&t.data&&a.FETCH_ADDITIONAL_REMARK()}))["catch"]((function(t){console.log(t)}))["finally"]((function(){}))},DELETE_ADDITIONAL_REMARK:function(t){var a=this;console.log(t),(0,s.Z)({method:"delete",url:"additional-remark/delete-additional-remark?id="+t.key,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id:t.key}}).then((function(t){200==t.status&&t.data&&a.FETCH_ADDITIONAL_REMARK()}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1}))},UPDATE_ADDITIONAL_REMARK:function(t){var a=this;console.log(t);var e=JSON.parse(localStorage.getItem("user")),n=new FormData;n.append("id",t.key),n.append("id_tag",this.$route.params.id_tag),n.append("id_inspection_record",this.id_inspection_record),n.append("file",this.file),n.append("file_path",this.file_path),n.append("remark_type",t.data.remark_type),n.append("remark_desc",t.data.remark_desc),n.append("created_time",t.data.created_time),n.append("created_by",t.data.created_by),n.append("updated_by",e.id_account),(0,s.Z)({method:"put",url:"additional-remark/edit-additional-remark?id="+t.key,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:n}).then((function(t){204==t.status&&a.FETCH_ADDITIONAL_REMARK()}))["catch"]((function(t){console.log(t)}))["finally"]((function(){a.isLoading=!1,a.is_changed_dwg=0}))},ON_ATTACHMENT_CHANGE:function(t){var a=this;console.log(t),this.isInitEdit=1;var e=new FileReader;e.readAsDataURL(t.value[0]),e.onload=function(){a.imgHolder=e.result},this.file=t.value[0]},EDITING_START_ADDITIONAL_REMARK:function(t){console.warn("EDIT"),console.log(t),this.file=[],this.isInitEdit=0,this.file_path=t.data.file_path,this.dataIMGTemp=t},SAVE:function(t){console.log("save:"),console.log(t),0==t.changes.length&&this.UPDATE_ADDITIONAL_REMARK(this.dataIMGTemp)},INIT_NEW_ROW_ADDITIONAL_REMARK:function(){this.imgHolder="",this.file=[],this.isInitEdit=1},SHOW_HIDE_PANEL:function(){this.pagePanelHiding=!this.pagePanelHiding},DATE_FORMAT:function(t){return l()(t).format("LL")}}},E=f;var T=e(1001),D=(0,T.Z)(E,n,i,!1,null,"1537ff42",null);const v=D.exports},3488:(t,a,e)=>{e.d(a,{Z:()=>h});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"inspection-record-panel",class:[0==t.panelHiding?"inspection-record-panel":"inspection-record-panel-hide"]},[1==t.panelHiding?e("div",{staticClass:"insp-panel-header"},[e("span",[t._v("Inspection Record")])]):t._e(),0==t.panelHiding?e("v-ons-list",[e("v-ons-list-header",[t._v("Inspection Record")]),t._l(t.inspectionList,(function(a){return e("v-ons-list-item",{key:a.id_inspection_record,staticStyle:{cursor:"pointer"},attrs:{tappable:"",id:[a.id_inspection_record]},on:{click:function(e){return t.VIEW_ITEM(a)}}},[e("div",{staticClass:"center"},[e("span",{staticClass:"date",staticStyle:{"margin-top":"5px"}},[t._v(t._s(t.DATE_FORMAT(a.inspection_date)))]),e("span",{staticStyle:{position:"absolute",bottom:"0",right:"14px","font-size":"12px",color:"red"}},[t._v("id_insp: "+t._s(a.id_inspection_record))])]),e("div",{staticClass:"right"},[e("v-ons-toolbar-button",[e("i",{staticClass:"las la-search"})])],1)])}))],2):t._e(),e("div",{staticClass:"fixed-panel"},[e("v-ons-toolbar-button",{staticClass:"item bottom-btn",on:{click:function(a){return t.SHOW_HIDE_PANEL()}}},[0==t.panelHiding?e("i",{staticClass:"las la-caret-square-left"}):t._e(),1==t.panelHiding?e("i",{staticClass:"las la-caret-square-right"}):t._e(),e("span",[t._v("Hide List")])])],1)],1)},i=[],o=e(4367),s=(e(41539),e(21249),e(39477)),r=e(17133),l=e.n(r);const d={name:"inspection-record-panel",data:function(){return{isLoading:!1,inspectionList:[],panelHiding:!1,current_view:{}}},created:function(){1==this.$store.state.status.server&&this.FETCH_INSP_RECORD()},watch:{$route:function(){this.current_view.id_inspection_record&&document.getElementById(this.current_view.id_inspection_record).classList.remove("active"),this.current_view.id_inspection_record=""}},methods:{FETCH_INSP_RECORD:function(){var t=this;this.inspectionList=[],this.isLoading=!0;var a=this.$route.params.id_tag;(0,s.Z)({method:"get",url:"/TankInspectionRecord/get-tank-ir-by-id-tag?id_tag="+a,headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{}}).then((function(a){200==a.status&&a.data&&(console.log("==> SUCCESS: Inspection Record"),t.inspectionList=a.data.map((function(t){return(0,o.Z)((0,o.Z)({},t),{},{id_inspection_record:t.id})})),console.log(t.inspectionList))}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))},DATE_FORMAT:function(t){return l()(t).format("LL")},SHOW_HIDE_PANEL:function(){1==this.panelHiding?this.panelHiding=!1:this.panelHiding=!0,this.$emit("showHidePanel")},VIEW_ITEM:function(t){this.current_view.id_inspection_record&&document.getElementById(this.current_view.id_inspection_record).classList.remove("active"),console.log("==> VIEW: Inspection Record Item"),console.log(t),this.$emit("viewItem",t),document.getElementById(t.id_inspection_record).classList.add("active"),this.current_view.id_inspection_record=t.id_inspection_record}}},c=d;var u=e(1001),p=(0,u.Z)(c,n,i,!1,null,"563a63c1",null);const h=p.exports}}]);
//# sourceMappingURL=4211.0d085cc0.js.map