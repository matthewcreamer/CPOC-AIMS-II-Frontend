"use strict";(self["webpackChunktims_dexon"]=self["webpackChunktims_dexon"]||[]).push([[8417],{78417:function(e,t,i){
/*!
 * devextreme-vue
 * Version: 21.2.7
 * Build date: Mon Apr 11 2022
 *
 * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */
i(69070),i(9653);var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DxFileUploader=void 0;var n=a(i(85069)),o=i(26876),l=o.createComponent({props:{abortUpload:Function,accept:String,accessKey:String,activeStateEnabled:Boolean,allowCanceling:Boolean,allowedFileExtensions:Array,chunkSize:Number,dialogTrigger:{},disabled:Boolean,dropZone:{},elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},invalidFileExtensionMessage:String,invalidMaxFileSizeMessage:String,invalidMinFileSizeMessage:String,isValid:Boolean,labelText:String,maxFileSize:Number,minFileSize:Number,multiple:Boolean,name:String,onBeforeSend:Function,onContentReady:Function,onDisposing:Function,onDropZoneEnter:Function,onDropZoneLeave:Function,onFilesUploaded:Function,onInitialized:Function,onOptionChanged:Function,onProgress:Function,onUploadAborted:Function,onUploaded:Function,onUploadError:Function,onUploadStarted:Function,onValueChanged:Function,progress:Number,readOnly:Boolean,readyToUploadMessage:String,rtlEnabled:Boolean,selectButtonText:String,showFileList:Boolean,tabIndex:Number,uploadAbortedMessage:String,uploadButtonText:String,uploadChunk:Function,uploadCustomData:{},uploadedMessage:String,uploadFailedMessage:String,uploadFile:Function,uploadHeaders:{},uploadMethod:String,uploadMode:String,uploadUrl:String,validationError:{},validationErrors:Array,validationStatus:String,value:Array,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:abortUpload":null,"update:accept":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:allowCanceling":null,"update:allowedFileExtensions":null,"update:chunkSize":null,"update:dialogTrigger":null,"update:disabled":null,"update:dropZone":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:invalidFileExtensionMessage":null,"update:invalidMaxFileSizeMessage":null,"update:invalidMinFileSizeMessage":null,"update:isValid":null,"update:labelText":null,"update:maxFileSize":null,"update:minFileSize":null,"update:multiple":null,"update:name":null,"update:onBeforeSend":null,"update:onContentReady":null,"update:onDisposing":null,"update:onDropZoneEnter":null,"update:onDropZoneLeave":null,"update:onFilesUploaded":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:onProgress":null,"update:onUploadAborted":null,"update:onUploaded":null,"update:onUploadError":null,"update:onUploadStarted":null,"update:onValueChanged":null,"update:progress":null,"update:readOnly":null,"update:readyToUploadMessage":null,"update:rtlEnabled":null,"update:selectButtonText":null,"update:showFileList":null,"update:tabIndex":null,"update:uploadAbortedMessage":null,"update:uploadButtonText":null,"update:uploadChunk":null,"update:uploadCustomData":null,"update:uploadedMessage":null,"update:uploadFailedMessage":null,"update:uploadFile":null,"update:uploadHeaders":null,"update:uploadMethod":null,"update:uploadMode":null,"update:uploadUrl":null,"update:validationError":null,"update:validationErrors":null,"update:validationStatus":null,"update:value":null,"update:visible":null,"update:width":null},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=n["default"],this.$_hasAsyncTemplate=!0}});t.DxFileUploader=l,t["default"]=l},85069:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Me});var a=i(76133),n=i(92751),o=i(50460),l=i(87349),s=i(99418),r=i(6812),u=(i(92222),i(24812),i(74916),i(15306),i(47042),i(57327),i(41539),i(69826),i(32564),i(89554),i(54747),i(68309),i(94986),i(40561),i(91038),i(78783),i(21249),i(82772),i(26541),i(23123),i(73210),i(4723),i(24603),i(28450),i(88386),i(39714),i(54678),i(38862),i(8767)),d=i(40555),p=i(97814),h=i(42632),c=i(50337),_=i(61025),v=i(30803),f=i(29532),g=i(69598),y=i(43908),m=i(33268),k=i(57566),F=i(63360),b=i(47767),S=i(80880),C=i(39598),Z="dx-trackbar",x="dx-trackbar-container",E="dx-trackbar-range",U="dx-trackbar-wrapper",B=b.Z.inherit({_getDefaultOptions:function(){return(0,y.l)(this.callBase(),{min:0,max:100,value:0})},_initMarkup:function(){this.$element().addClass(Z),this._renderWrapper(),this._renderContainer(),this._renderRange(),this._renderValue(),this._setRangeStyles(),this.callBase()},_render:function(){this.callBase(),this._setRangeStyles(this._rangeStylesConfig())},_renderWrapper:function(){this._$wrapper=(0,d.Z)("<div>").addClass(U).appendTo(this.$element())},_renderContainer:function(){this._$bar=(0,d.Z)("<div>").addClass(x).appendTo(this._$wrapper)},_renderRange:function(){this._$range=(0,d.Z)("<div>").addClass(E).appendTo(this._$bar)},_renderValue:function(){var e=this.option("value"),t=this.option("min"),i=this.option("max");if(!(t>i)){if(e<t)return this.option("value",t),void(this._currentRatio=0);if(e>i)return this.option("value",i),void(this._currentRatio=1);var a=t===i?0:(e-t)/(i-t);!this._needPreventAnimation&&this._setRangeStyles({width:100*a+"%"}),this.setAria({valuemin:this.option("min"),valuemax:i,valuenow:e}),this._currentRatio=a}},_rangeStylesConfig:function(){return{width:100*this._currentRatio+"%"}},_setRangeStyles:function(e){C.Z.stop(this._$range),e?!this._needPreventAnimation&&(0,h.Ym)()&&C.Z.animate(this._$range,{type:"custom",duration:100,to:e}):this._$range.css({width:0})},_optionChanged:function(e){switch(e.name){case"value":this._renderValue(),this.callBase(e);break;case"max":case"min":this._renderValue();break;default:this.callBase(e)}},_dispose:function(){C.Z.stop(this._$range),this.callBase()}});(0,_.Z)("dxTrackBar",B);const M=B;var A="dx-progressbar",$="dx-progressbar-container",D="dx-progressbar-range-container",T="dx-progressbar-range",z="dx-progressbar-wrapper",I="dx-progressbar-status",L="dx-progressbar-animating-container",w="dx-progressbar-animating-segment",O=M.inherit({_getDefaultOptions:function(){return(0,y.l)(this.callBase(),{value:0,statusFormat:function(e){return"Progress: "+Math.round(100*e)+"%"},showStatus:!0,onComplete:null,activeStateEnabled:!1,statusPosition:"bottom left",_animatingSegmentCount:0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(e){return"android"===e.platform},options:{_animatingSegmentCount:2}}])},_initMarkup:function(){this._renderStatus(),this._createCompleteAction(),this.callBase(),this.$element().addClass(A),this._$wrapper.addClass(z),this._$bar.addClass($),this.setAria("role","progressbar"),(0,d.Z)("<div>").addClass(D).appendTo(this._$wrapper).append(this._$bar),this._$range.addClass(T),this._toggleStatus(this.option("showStatus"))},_useTemplates:function(){return!1},_createCompleteAction:function(){this._completeAction=this._createActionByOption("onComplete")},_renderStatus:function(){this._$status=(0,d.Z)("<div>").addClass(I)},_renderIndeterminateState:function(){this._$segmentContainer=(0,d.Z)("<div>").addClass(L);for(var e=this.option("_animatingSegmentCount"),t=0;t<e;t++)(0,d.Z)("<div>").addClass(w).addClass(w+"-"+(t+1)).appendTo(this._$segmentContainer);this._$segmentContainer.appendTo(this._$wrapper)},_toggleStatus:function(e){var t=this.option("statusPosition").split(" ");e?"top"===t[0]||"left"===t[0]?this._$status.prependTo(this._$wrapper):this._$status.appendTo(this._$wrapper):this._$status.detach(),this._togglePositionClass()},_togglePositionClass:function(){var e=this.option("statusPosition"),t=e.split(" ");this._$wrapper.removeClass("dx-position-top-left dx-position-top-right dx-position-bottom-left dx-position-bottom-right dx-position-left dx-position-right");var i="dx-position-"+t[0];t[1]&&(i+="-"+t[1]),this._$wrapper.addClass(i)},_toggleIndeterminateState:function(e){e?(this._renderIndeterminateState(),this._$bar.toggle(!1)):(this._$bar.toggle(!0),this._$segmentContainer.remove(),delete this._$segmentContainer)},_renderValue:function(){var e=this.option("value"),t=this.option("max");e||0===e?(this._$segmentContainer&&this._toggleIndeterminateState(!1),e===t&&this._completeAction(),this.callBase(),this._setStatus()):this._toggleIndeterminateState(!0)},_setStatus:function(){var e=this.option("statusFormat");e=(0,f.mf)(e)?e.bind(this):function(e){return e};var t=e(this._currentRatio,this.option("value"));this._$status.text(t)},_dispose:function(){this._$status.remove(),this.callBase()},_optionChanged:function(e){switch(e.name){case"statusFormat":this._setStatus();break;case"showStatus":this._toggleStatus(e.value);break;case"statusPosition":this._toggleStatus(this.option("showStatus"));break;case"onComplete":this._createCompleteAction();break;case"_animatingSegmentCount":break;default:this.callBase(e)}}});(0,_.Z)("dxProgressBar",O);const H=O;var P=i(75395),V=i(31925),R=i(4872),N=i(946),W=i(19868),q=i(90170),K=(0,h.Jj)(),j="dx-fileuploader",Y="dx-fileuploader-empty",X="dx-fileuploader-show-file-list",G="dx-fileuploader-dragover",J="dx-fileuploader-wrapper",Q="dx-fileuploader-container",ee="dx-fileuploader-content",te="dx-fileuploader-input-wrapper",ie="dx-fileuploader-input-container",ae="dx-fileuploader-input-label",ne="dx-fileuploader-input",oe="dx-fileuploader-files-container",le="dx-fileuploader-file-container",se="dx-fileuploader-file-info",re="dx-fileuploader-file-status-message",ue="dx-fileuploader-file",de="dx-fileuploader-file-name",pe="dx-fileuploader-file-size",he="dx-fileuploader-button",ce="dx-fileuploader-button-container",_e="dx-fileuploader-cancel-button",ve="dx-fileuploader-upload-button",fe="dx-fileuploader-invalid",ge=400,ye="chunkMetadata",me=function(){return(0,d.Z)("<input>").attr("type","file")},ke=function(){return!!K.FormData},Fe=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_supportedKeys",value:function(){var e=this,t=function(t){t.preventDefault();var i=e._selectButton.$element();c.Z.trigger(i,R.u)};return(0,y.l)((0,o.Z)((0,l.Z)(i.prototype),"_supportedKeys",this).call(this),{space:t,enter:t})}},{key:"_setOptionsByReference",value:function(){(0,o.Z)((0,l.Z)(i.prototype),"_setOptionsByReference",this).call(this),(0,y.l)(this._optionsByReference,{value:!0})}},{key:"_getDefaultOptions",value:function(){return(0,y.l)((0,o.Z)((0,l.Z)(i.prototype),"_getDefaultOptions",this).call(this),{chunkSize:0,value:[],selectButtonText:N.Z.format("dxFileUploader-selectFile"),uploadButtonText:N.Z.format("dxFileUploader-upload"),labelText:N.Z.format("dxFileUploader-dropFile"),name:"files[]",multiple:!1,accept:"",uploadUrl:"/",allowCanceling:!0,showFileList:!0,progress:0,dialogTrigger:void 0,dropZone:void 0,readyToUploadMessage:N.Z.format("dxFileUploader-readyToUpload"),uploadedMessage:N.Z.format("dxFileUploader-uploaded"),uploadFailedMessage:N.Z.format("dxFileUploader-uploadFailedMessage"),uploadAbortedMessage:N.Z.format("dxFileUploader-uploadAbortedMessage"),uploadMode:"instantly",uploadMethod:"POST",uploadHeaders:{},uploadCustomData:{},onBeforeSend:null,onUploadStarted:null,onUploaded:null,onFilesUploaded:null,onProgress:null,onUploadError:null,onUploadAborted:null,onDropZoneEnter:null,onDropZoneLeave:null,allowedFileExtensions:[],maxFileSize:0,minFileSize:0,inputAttr:{},invalidFileExtensionMessage:N.Z.format("dxFileUploader-invalidFileExtension"),invalidMaxFileSizeMessage:N.Z.format("dxFileUploader-invalidMaxFileSize"),invalidMinFileSizeMessage:N.Z.format("dxFileUploader-invalidMinFileSize"),extendSelection:!0,validationMessageMode:"always",uploadFile:null,uploadChunk:null,abortUpload:null,validationMessageOffset:{h:0,v:0},hoverStateEnabled:!0,useNativeInputClick:!1,useDragOver:!0,nativeDropSupported:!0,_uploadButtonType:"normal"})}},{key:"_defaultOptionsRules",value:function(){return(0,o.Z)((0,l.Z)(i.prototype),"_defaultOptionsRules",this).call(this).concat([{device:function(){return"desktop"===P.Z.real().deviceType&&!P.Z.isSimulator()},options:{focusStateEnabled:!0}},{device:[{platform:"android"}],options:{validationMessageOffset:{v:0}}},{device:function(){return"desktop"!==P.Z.real().deviceType},options:{useDragOver:!1}},{device:function(){return!ke()},options:{uploadMode:"useForm"}},{device:function(){return"desktop"!==P.Z.real().deviceType},options:{nativeDropSupported:!1}},{device:function(){return(0,W.x2)()},options:{_uploadButtonType:"default"}}])}},{key:"_initOptions",value:function(e){var t="labelText"in e;(0,o.Z)((0,l.Z)(i.prototype),"_initOptions",this).call(this,e),t||this._shouldDragOverBeRendered()||this.option("labelText","")}},{key:"_init",value:function(){(0,o.Z)((0,l.Z)(i.prototype),"_init",this).call(this),this._initFileInput(),this._initLabel(),this._setUploadStrategy(),this._createFiles(),this._createBeforeSendAction(),this._createUploadStartedAction(),this._createUploadedAction(),this._createFilesUploadedAction(),this._createProgressAction(),this._createUploadErrorAction(),this._createUploadAbortedAction(),this._createDropZoneEnterAction(),this._createDropZoneLeaveAction()}},{key:"_setUploadStrategy",value:function(){var e=null;if(this.option("chunkSize")>0){var t=this.option("uploadChunk");e=t&&(0,f.mf)(t)?new xe(this):new Ze(this)}else{var i=this.option("uploadFile");e=i&&(0,f.mf)(i)?new Be(this):new Ue(this)}this._uploadStrategy=e}},{key:"_initFileInput",value:function(){var e=this;this._isCustomClickEvent=!1,this._$fileInput||(this._$fileInput=me(),c.Z.on(this._$fileInput,"change",this._inputChangeHandler.bind(this)),c.Z.on(this._$fileInput,"click",(function(t){return t.stopPropagation(),e._resetInputValue(),e.option("useNativeInputClick")||e._isCustomClickEvent}))),this._$fileInput.prop({multiple:this.option("multiple"),accept:this.option("accept"),tabIndex:-1})}},{key:"_inputChangeHandler",value:function(){if(!this._doPreventInputChange){var e=this._$fileInput.val().replace(/^.*\\/,""),t=this._$fileInput.prop("files");if(!t||t.length||"useForm"===this.option("uploadMode")){var i=t?this._getFiles(t):[{name:e}];this._changeValue(i),"instantly"===this.option("uploadMode")&&this._uploadFiles()}}}},{key:"_shouldFileListBeExtended",value:function(){return"useForm"!==this.option("uploadMode")&&this.option("extendSelection")&&this.option("multiple")}},{key:"_changeValue",value:function(e){var t=this._shouldFileListBeExtended()?this.option("value").slice():[];this.option("value",t.concat(e))}},{key:"_getFiles",value:function(e){var t=[];return(0,g.S6)(e,(function(e,i){return t.push(i)})),t}},{key:"_getFile",value:function(e){var t=(0,f.kE)(e)?this.option("value")[e]:e;return this._files.filter((function(e){return e.value===t}))[0]}},{key:"_initLabel",value:function(){this._$inputLabel||(this._$inputLabel=(0,d.Z)("<div>")),this._updateInputLabelText()}},{key:"_updateInputLabelText",value:function(){var e=this._isInteractionDisabled()?"":this.option("labelText");this._$inputLabel.text(e)}},{key:"_focusTarget",value:function(){return this.$element().find("."+he)}},{key:"_getSubmitElement",value:function(){return this._$fileInput}},{key:"_initMarkup",value:function(){(0,o.Z)((0,l.Z)(i.prototype),"_initMarkup",this).call(this),this.$element().addClass(j),this._renderWrapper(),this._renderInputWrapper(),this._renderSelectButton(),this._renderInputContainer(),this._renderUploadButton(),this._preventRecreatingFiles=!0,this._activeDropZone=null}},{key:"_render",value:function(){this._preventRecreatingFiles=!1,this._attachDragEventHandlers(this._$inputWrapper),this._attachDragEventHandlers(this.option("dropZone")),this._renderFiles(),(0,o.Z)((0,l.Z)(i.prototype),"_render",this).call(this)}},{key:"_createFileProgressBar",value:function(e){e.progressBar=this._createProgressBar(e.value.size),e.progressBar.$element().appendTo(e.$file),this._initStatusMessage(e),this._ensureCancelButtonInitialized(e)}},{key:"_setStatusMessage",value:function(e,t){var i=this;setTimeout((function(){i.option("showFileList")&&e.$statusMessage&&(e.$statusMessage.text(t),e.$statusMessage.css("display",""),e.progressBar.$element().remove())}),ge)}},{key:"_getUploadAbortedStatusMessage",value:function(){return"instantly"===this.option("uploadMode")?this.option("uploadAbortedMessage"):this.option("readyToUploadMessage")}},{key:"_createFiles",value:function(){var e=this,t=this.option("value");!this._files||0!==t.length&&this._shouldFileListBeExtended()||(this._preventFilesUploading(this._files),this._files=null),this._files||(this._files=[]),(0,g.S6)(t.slice(this._files.length),(function(t,i){var a=e._createFile(i);e._validateFile(a),e._files.push(a)}))}},{key:"_preventFilesUploading",value:function(e){var t=this;e.forEach((function(e){return t._uploadStrategy.abortUpload(e)}))}},{key:"_validateFile",value:function(e){e.isValidFileExtension=this._validateFileExtension(e),e.isValidMinSize=this._validateMinFileSize(e),e.isValidMaxSize=this._validateMaxFileSize(e)}},{key:"_validateFileExtension",value:function(e){var t=this.option("allowedFileExtensions"),i=this.option("accept"),a=this._getAllowedFileTypes(i),n=e.value.name.substring(e.value.name.lastIndexOf(".")).toLowerCase();if(0!==i.length&&!this._isFileTypeAllowed(e.value,a))return!1;if(0===t.length)return!0;for(var o=0;o<t.length;o++)if(n===t[o].toLowerCase())return!0;return!1}},{key:"_validateMaxFileSize",value:function(e){var t=e.value.size,i=this.option("maxFileSize");return!(i>0)||t<=i}},{key:"_validateMinFileSize",value:function(e){var t=e.value.size,i=this.option("minFileSize");return!(i>0)||t>=i}},{key:"_createBeforeSendAction",value:function(){this._beforeSendAction=this._createActionByOption("onBeforeSend",{excludeValidators:["readOnly"]})}},{key:"_createUploadStartedAction",value:function(){this._uploadStartedAction=this._createActionByOption("onUploadStarted",{excludeValidators:["readOnly"]})}},{key:"_createUploadedAction",value:function(){this._uploadedAction=this._createActionByOption("onUploaded",{excludeValidators:["readOnly"]})}},{key:"_createFilesUploadedAction",value:function(){this._filesUploadedAction=this._createActionByOption("onFilesUploaded",{excludeValidators:["readOnly"]})}},{key:"_createProgressAction",value:function(){this._progressAction=this._createActionByOption("onProgress",{excludeValidators:["readOnly"]})}},{key:"_createUploadAbortedAction",value:function(){this._uploadAbortedAction=this._createActionByOption("onUploadAborted",{excludeValidators:["readOnly"]})}},{key:"_createUploadErrorAction",value:function(){this._uploadErrorAction=this._createActionByOption("onUploadError",{excludeValidators:["readOnly"]})}},{key:"_createDropZoneEnterAction",value:function(){this._dropZoneEnterAction=this._createActionByOption("onDropZoneEnter")}},{key:"_createDropZoneLeaveAction",value:function(){this._dropZoneLeaveAction=this._createActionByOption("onDropZoneLeave")}},{key:"_createFile",value:function(e){return{value:e,loadedSize:0,onProgress:(0,v["default"])(),onAbort:(0,v["default"])(),onLoad:(0,v["default"])(),onError:(0,v["default"])(),onLoadStart:(0,v["default"])(),isValidFileExtension:!0,isValidMaxSize:!0,isValidMinSize:!0,isValid:function(){return this.isValidFileExtension&&this.isValidMaxSize&&this.isValidMinSize},isInitialized:!1}}},{key:"_resetFileState",value:function(e){e.isAborted=!1,e.uploadStarted=!1,e.isStartLoad=!1,e.loadedSize=0,e.chunksData=void 0,e.request=void 0}},{key:"_renderFiles",value:function(){var e,t=this,i=this.option("value");this._$filesContainer?this._shouldFileListBeExtended()&&0!==i.length||this._$filesContainer.empty():this._$filesContainer=(0,d.Z)("<div>").addClass(oe).appendTo(this._$content);var a=this.option("showFileList");a&&(0,g.S6)(this._files,(function(e,i){i.$file||t._renderFile(i)})),this.$element().toggleClass(X,a),this._toggleFileUploaderEmptyClassName(),this._updateFileNameMaxWidth(),null===(e=this._validationMessage)||void 0===e||e.repaint()}},{key:"_renderFile",value:function(e){var t=e.value,i=(0,d.Z)("<div>").addClass(le).appendTo(this._$filesContainer);this._renderFileButtons(e,i),e.$file=(0,d.Z)("<div>").addClass(ue).appendTo(i);var a=(0,d.Z)("<div>").addClass(se).appendTo(e.$file);e.$statusMessage=(0,d.Z)("<div>").addClass(re).appendTo(e.$file),(0,d.Z)("<div>").addClass(de).text(t.name).appendTo(a),(0,f.$K)(t.size)&&(0,d.Z)("<div>").addClass(pe).text(this._getFileSize(t.size)).appendTo(a),e.isValid()?e.$statusMessage.text(this.option("readyToUploadMessage")):(e.isValidFileExtension||e.$statusMessage.append(this._createValidationElement("invalidFileExtensionMessage")),e.isValidMaxSize||e.$statusMessage.append(this._createValidationElement("invalidMaxFileSizeMessage")),e.isValidMinSize||e.$statusMessage.append(this._createValidationElement("invalidMinFileSizeMessage")),i.addClass(fe))}},{key:"_createValidationElement",value:function(e){return(0,d.Z)("<span>").text(this.option(e))}},{key:"_updateFileNameMaxWidth",value:function(){var e=this.option("allowCanceling")&&"useForm"!==this.option("uploadMode")?1:0,t="useButtons"===this.option("uploadMode")?1:0,i=(0,u.dz)(this._$filesContainer.find("."+le).first())||(0,u.dz)(this._$filesContainer),a=this._$filesContainer.find("."+ce).eq(0),n=(0,u.dz)(a)*(e+t),o=this._$filesContainer.find("."+pe).eq(0),l=o.text();o.text("1000 Mb");var s=(0,u.dz)(o);o.text(l),this._$filesContainer.find("."+de).css("maxWidth",i-n-s)}},{key:"_renderFileButtons",value:function(e,t){var i=this._getCancelButton(e);i&&t.append(i);var a=this._getUploadButton(e);a&&t.append(a)}},{key:"_getCancelButton",value:function(e){var t=this;return"useForm"===this.option("uploadMode")?null:(e.cancelButton=this._createComponent((0,d.Z)("<div>").addClass(he+" "+_e),S["default"],{onClick:function(){return t._removeFile(e)},icon:"close",visible:this.option("allowCanceling"),disabled:this.option("readOnly"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")}),(0,d.Z)("<div>").addClass(ce).append(e.cancelButton.$element()))}},{key:"_getUploadButton",value:function(e){var t=this;return e.isValid()&&"useButtons"===this.option("uploadMode")?(e.uploadButton=this._createComponent((0,d.Z)("<div>").addClass(he+" "+ve),S["default"],{onClick:function(){return t._uploadFile(e)},icon:"upload",hoverStateEnabled:this.option("hoverStateEnabled")}),e.onLoadStart.add((function(){return e.uploadButton.option({visible:!1,disabled:!0})})),e.onAbort.add((function(){return e.uploadButton.option({visible:!0,disabled:!1})})),(0,d.Z)("<div>").addClass(ce).append(e.uploadButton.$element())):null}},{key:"_removeFile",value:function(e){var t;null===(t=e.$file)||void 0===t||t.parent().remove(),this._files.splice((0,m.d3)(e,this._files),1);var i=this.option("value").slice();i.splice((0,m.d3)(e.value,i),1),this._preventRecreatingFiles=!0,this.option("value",i),this._preventRecreatingFiles=!1,this._toggleFileUploaderEmptyClassName(),this._resetInputValue(!0)}},{key:"removeFile",value:function(e){if("useForm"!==this.option("uploadMode")&&(0,f.$K)(e)){var t=this._getFile(e);t&&(t.uploadStarted&&this._preventFilesUploading([t]),this._removeFile(t))}}},{key:"_toggleFileUploaderEmptyClassName",value:function(){this.$element().toggleClass(Y,!this._files.length||this._hasInvalidFile(this._files))}},{key:"_hasInvalidFile",value:function(e){for(var t=0;t<e.length;t++)if(!e[t].isValid())return!0;return!1}},{key:"_getFileSize",value:function(e){var t=0,i=[N.Z.format("dxFileUploader-bytes"),N.Z.format("dxFileUploader-kb"),N.Z.format("dxFileUploader-Mb"),N.Z.format("dxFileUploader-Gb")],a=i.length-1;while(t<a&&e>=1024)e/=1024,t++;return Math.round(e)+" "+i[t]}},{key:"_renderSelectButton",value:function(){var e=(0,d.Z)("<div>").addClass(he).appendTo(this._$inputWrapper);this._selectButton=this._createComponent(e,S["default"],{text:this.option("selectButtonText"),focusStateEnabled:!1,integrationOptions:{},disabled:this.option("readOnly"),hoverStateEnabled:this.option("hoverStateEnabled")}),this._selectFileDialogHandler=this._selectButtonClickHandler.bind(this),"desktop"===P.Z.real().deviceType?this._selectButton.option("onClick",this._selectFileDialogHandler):this._attachSelectFileDialogHandler(this._selectButton.$element()),this._attachSelectFileDialogHandler(this.option("dialogTrigger"))}},{key:"_selectButtonClickHandler",value:function(){if(!this.option("useNativeInputClick")){if(this._isInteractionDisabled())return!1;this._isCustomClickEvent=!0,c.Z.trigger(this._$fileInput,"click"),this._isCustomClickEvent=!1}}},{key:"_attachSelectFileDialogHandler",value:function(e){(0,f.$K)(e)&&(this._detachSelectFileDialogHandler(e),c.Z.on((0,d.Z)(e),"click",this._selectFileDialogHandler))}},{key:"_detachSelectFileDialogHandler",value:function(e){(0,f.$K)(e)&&c.Z.off((0,d.Z)(e),"click",this._selectFileDialogHandler)}},{key:"_renderUploadButton",value:function(){if("useButtons"===this.option("uploadMode")){var e=(0,d.Z)("<div>").addClass(he).addClass(ve).appendTo(this._$content);this._uploadButton=this._createComponent(e,S["default"],{text:this.option("uploadButtonText"),onClick:this._uploadButtonClickHandler.bind(this),type:this.option("_uploadButtonType"),integrationOptions:{},hoverStateEnabled:this.option("hoverStateEnabled")})}}},{key:"_uploadButtonClickHandler",value:function(){this._uploadFiles()}},{key:"_shouldDragOverBeRendered",value:function(){return!this.option("readOnly")&&("useForm"!==this.option("uploadMode")||this.option("nativeDropSupported"))}},{key:"_isInteractionDisabled",value:function(){return this.option("readOnly")||this.option("disabled")}},{key:"_renderInputContainer",value:function(){this._$inputContainer=(0,d.Z)("<div>").addClass(ie).appendTo(this._$inputWrapper),this._$fileInput.addClass(ne),this._renderInput();var e="dx-fileuploader-input-label-".concat(new p.Z);this._$inputLabel.attr("id",e).addClass(ae).appendTo(this._$inputContainer),this.setAria("labelledby",e,this._$fileInput)}},{key:"_renderInput",value:function(){this.option("useNativeInputClick")?this._selectButton.option("template",this._selectButtonInputTemplate.bind(this)):(this._$fileInput.appendTo(this._$inputContainer),this._selectButton.option("template","content")),this._applyInputAttributes(this.option("inputAttr"))}},{key:"_selectButtonInputTemplate",value:function(e,t){var i=(0,d.Z)(t),a=(0,d.Z)("<span>").addClass("dx-button-text").text(e.text);return i.append(a).append(this._$fileInput),i}},{key:"_renderInputWrapper",value:function(){this._$inputWrapper=(0,d.Z)("<div>").addClass(te).appendTo(this._$content)}},{key:"_detachDragEventHandlers",value:function(e){(0,f.$K)(e)&&c.Z.off((0,d.Z)(e),(0,V.V4)("",this.NAME))}},{key:"_attachDragEventHandlers",value:function(e){var t=e!==this._$inputWrapper;(0,f.$K)(e)&&this._shouldDragOverBeRendered()&&(this._detachDragEventHandlers(e),e=(0,d.Z)(e),c.Z.on(e,(0,V.V4)("dragenter",this.NAME),this._dragEnterHandler.bind(this,t)),c.Z.on(e,(0,V.V4)("dragover",this.NAME),this._dragOverHandler.bind(this,t)),c.Z.on(e,(0,V.V4)("dragleave",this.NAME),this._dragLeaveHandler.bind(this,t)),c.Z.on(e,(0,V.V4)("drop",this.NAME),this._dropHandler.bind(this,t)))}},{key:"_applyInputAttributes",value:function(e){this._$fileInput.attr(e)}},{key:"_useInputForDrop",value:function(){return this.option("nativeDropSupported")&&"useForm"===this.option("uploadMode")}},{key:"_getDropZoneElement",value:function(e,t){var i=e?Array.from((0,d.Z)(this.option("dropZone"))):[this._$inputWrapper];return i=i.map((function(e){return(0,d.Z)(e).get(0)})),i[i.indexOf(t.currentTarget)]}},{key:"_dragEnterHandler",value:function(e,t){if(this.option("disabled"))return!1;this._useInputForDrop()||t.preventDefault();var i=this._getDropZoneElement(e,t);(0,f.$K)(i)&&null===this._activeDropZone&&this.isMouseOverElement(t,i,!1)&&(this._activeDropZone=i,this._tryToggleDropZoneActive(!0,e,t))}},{key:"_dragOverHandler",value:function(e,t){if(this._useInputForDrop()||t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy",!e){var i=this._getDropZoneElement(!1,t);null===this._activeDropZone&&this.isMouseOverElement(t,i,!1)&&this._dragEnterHandler(!1,t),null!==this._activeDropZone&&this._shouldRaiseDragLeave(t,!1)&&this._dragLeaveHandler(!1,t)}}},{key:"_dragLeaveHandler",value:function(e,t){this._useInputForDrop()||t.preventDefault(),null!==this._activeDropZone&&this._shouldRaiseDragLeave(t,e)&&(this._tryToggleDropZoneActive(!1,e,t),this._activeDropZone=null)}},{key:"_shouldRaiseDragLeave",value:function(e,t){return!this.isMouseOverElement(e,this._activeDropZone,!t)}},{key:"_tryToggleDropZoneActive",value:function(e,t,i){var a=e?"addClass":"removeClass",n=e?"_dropZoneEnterAction":"_dropZoneLeaveAction";this[n]({event:i,dropZoneElement:this._activeDropZone}),t||this.$element()[a](G)}},{key:"_dropHandler",value:function(e,t){if(this._activeDropZone=null,e||this.$element().removeClass(G),!(this._useInputForDrop()||e&&this._isInteractionDisabled())){t.preventDefault();var i=t.originalEvent.dataTransfer.files,a=this._getFiles(i);!this.option("multiple")&&a.length>1||(this._changeValue(a),"instantly"===this.option("uploadMode")&&this._uploadFiles())}}},{key:"_handleAllFilesUploaded",value:function(){var e=this._files.every((function(e){return!e.isValid()||e._isError||e._isLoaded||e.isAborted}));e&&this._filesUploadedAction()}},{key:"_getAllowedFileTypes",value:function(e){return e.length?e.split(",").map((function(e){return e.trim()})):[]}},{key:"_isFileTypeAllowed",value:function(e,t){for(var i=0,a=t.length;i<a;i++){var n=t[i];if("."===n[0]){if(n=n.replace(".","\\."),e.name.match(new RegExp(n+"$","i")))return!0}else if(n=n.replace(new RegExp("\\*","g"),""),e.type.match(new RegExp(n,"i")))return!0}return!1}},{key:"_renderWrapper",value:function(){var e=(0,d.Z)("<div>").addClass(J).appendTo(this.$element()),t=(0,d.Z)("<div>").addClass(Q).appendTo(e);this._$content=(0,d.Z)("<div>").addClass(ee).appendTo(t)}},{key:"_clean",value:function(){this._$fileInput.detach(),delete this._$filesContainer,this._detachSelectFileDialogHandler(this.option("dialogTrigger")),this._detachDragEventHandlers(this.option("dropZone")),this._files&&this._files.forEach((function(e){e.$file=null,e.$statusMessage=null})),(0,o.Z)((0,l.Z)(i.prototype),"_clean",this).call(this)}},{key:"abortUpload",value:function(e){if("useForm"!==this.option("uploadMode"))if((0,f.$K)(e)){var t=this._getFile(e);t&&this._preventFilesUploading([t])}else this._preventFilesUploading(this._files)}},{key:"upload",value:function(e){if("useForm"!==this.option("uploadMode"))if((0,f.$K)(e)){var t=this._getFile(e);t&&ke()&&this._uploadFile(t)}else this._uploadFiles()}},{key:"_uploadFiles",value:function(){var e=this;ke()&&(0,g.S6)(this._files,(function(t,i){return e._uploadFile(i)}))}},{key:"_uploadFile",value:function(e){this._uploadStrategy.upload(e)}},{key:"_updateProgressBar",value:function(e,t){e.progressBar&&e.progressBar.option({value:t.loaded,showStatus:!0}),this._progressAction({file:e.value,segmentSize:t.currentSegmentSize,bytesLoaded:t.loaded,bytesTotal:t.total,event:t.event,request:e.request})}},{key:"_updateTotalProgress",value:function(e,t){var i=e?this._getProgressValue(t/e):0;this.option("progress",i),this._setLoadedSize(t)}},{key:"_getProgressValue",value:function(e){return Math.floor(100*e)}},{key:"_initStatusMessage",value:function(e){e.$statusMessage.css("display","none")}},{key:"_ensureCancelButtonInitialized",value:function(e){var t=this;if(!e.isInitialized){e.cancelButton.option("onClick",(function(){t._preventFilesUploading([e]),t._removeFile(e)}));var i=function(){setTimeout((function(){e.cancelButton.option({visible:!1})}),ge)};e.onLoad.add(i),e.onError.add(i)}}},{key:"_createProgressBar",value:function(e){var t=this;return this._createComponent((0,d.Z)("<div>"),H,{value:void 0,min:0,max:e,statusFormat:function(e){return t._getProgressValue(e)+"%"},showStatus:!1,statusPosition:"right"})}},{key:"_getTotalFilesSize",value:function(){var e=this;return this._totalFilesSize||(this._totalFilesSize=0,(0,g.S6)(this._files,(function(t,i){e._totalFilesSize+=i.value.size}))),this._totalFilesSize}},{key:"_getTotalLoadedFilesSize",value:function(){var e=this;return this._totalLoadedFilesSize||(this._totalLoadedFilesSize=0,(0,g.S6)(this._files,(function(t,i){e._totalLoadedFilesSize+=i.loadedSize}))),this._totalLoadedFilesSize}},{key:"_setLoadedSize",value:function(e){this._totalLoadedFilesSize=e}},{key:"_recalculateProgress",value:function(){this._totalFilesSize=0,this._totalLoadedFilesSize=0,this._updateTotalProgress(this._getTotalFilesSize(),this._getTotalLoadedFilesSize())}},{key:"isMouseOverElement",value:function(e,t,i){if(!t)return!1;var a=i?parseFloat(K.getComputedStyle(t,":before").height):0,n=i?parseFloat(K.getComputedStyle(t,":after").height):0,o=(0,u.os)(t).left,l=(0,u.os)(t).top+a,s=t.offsetWidth,r=t.offsetHeight-a-n,d=this._getEventX(e),p=this._getEventY(e);return d>=o&&d<o+s&&p>=l&&p<l+r}},{key:"_getEventX",value:function(e){return(0,V.z6)(e)?this._getTouchEventX(e):e.clientX+this._getDocumentScrollLeft()}},{key:"_getEventY",value:function(e){return(0,V.z6)(e)?this._getTouchEventY(e):e.clientY+this._getDocumentScrollTop()}},{key:"_getTouchEventX",value:function(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageX:0}},{key:"_getTouchEventY",value:function(e){var t=null;return e.changedTouches.length>0?t=e.changedTouches:e.targetTouches.length>0&&(t=e.targetTouches),t?t[0].pageY:0}},{key:"_getDocumentScrollTop",value:function(){var e=q["default"].getDocument();return e.documentElement.scrollTop||e.body.scrollTop}},{key:"_getDocumentScrollLeft",value:function(){var e=q["default"].getDocument();return e.documentElement.scrollLeft||e.body.scrollLeft}},{key:"_updateReadOnlyState",value:function(){var e=this.option("readOnly");this._selectButton.option("disabled",e),this._files.forEach((function(t){var i;return null===(i=t.cancelButton)||void 0===i?void 0:i.option("disabled",e)})),this._updateInputLabelText(),this._attachDragEventHandlers(this._$inputWrapper)}},{key:"_updateHoverState",value:function(){var e,t,i=this.option("hoverStateEnabled");null===(e=this._selectButton)||void 0===e||e.option("hoverStateEnabled",i),null===(t=this._uploadButton)||void 0===t||t.option("hoverStateEnabled",i),this._files.forEach((function(e){var t,a;null===(t=e.uploadButton)||void 0===t||t.option("hoverStateEnabled",i),null===(a=e.cancelButton)||void 0===a||a.option("hoverStateEnabled",i)}))}},{key:"_optionChanged",value:function(e){var t=e.name,a=e.value,n=e.previousValue;switch(t){case"height":case"width":this._updateFileNameMaxWidth(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"value":!a.length&&this._$fileInput.val(""),this._preventRecreatingFiles||(this._createFiles(),this._renderFiles()),this._recalculateProgress(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"name":this._initFileInput(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"accept":this._initFileInput();break;case"multiple":this._initFileInput(),e.value||this.reset();break;case"readOnly":this._updateReadOnlyState(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"disabled":this._updateInputLabelText(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"selectButtonText":this._selectButton.option("text",a);break;case"uploadButtonText":this._uploadButton&&this._uploadButton.option("text",a);break;case"_uploadButtonType":this._uploadButton&&this._uploadButton.option("type",a);break;case"dialogTrigger":this._detachSelectFileDialogHandler(n),this._attachSelectFileDialogHandler(a);break;case"dropZone":this._detachDragEventHandlers(n),this._attachDragEventHandlers(a);break;case"maxFileSize":case"minFileSize":case"allowedFileExtensions":case"invalidFileExtensionMessage":case"invalidMaxFileSizeMessage":case"invalidMinFileSizeMessage":case"readyToUploadMessage":case"uploadedMessage":case"uploadFailedMessage":case"uploadAbortedMessage":this._invalidate();break;case"labelText":this._updateInputLabelText();break;case"showFileList":this._preventRecreatingFiles||this._renderFiles();break;case"uploadFile":case"uploadChunk":case"chunkSize":this._setUploadStrategy();break;case"abortUpload":case"uploadUrl":case"progress":case"uploadMethod":case"uploadHeaders":case"uploadCustomData":case"extendSelection":break;case"hoverStateEnabled":this._updateHoverState(),(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e);break;case"allowCanceling":case"uploadMode":this.reset(),this._invalidate();break;case"onBeforeSend":this._createBeforeSendAction();break;case"onUploadStarted":this._createUploadStartedAction();break;case"onUploaded":this._createUploadedAction();break;case"onFilesUploaded":this._createFilesUploadedAction();break;case"onProgress":this._createProgressAction();break;case"onUploadError":this._createUploadErrorAction();break;case"onUploadAborted":this._createUploadAbortedAction();break;case"onDropZoneEnter":this._createDropZoneEnterAction();break;case"onDropZoneLeave":this._createDropZoneLeaveAction();break;case"useNativeInputClick":this._renderInput();break;case"useDragOver":this._attachDragEventHandlers(this._$inputWrapper);break;case"nativeDropSupported":this._invalidate();break;case"inputAttr":this._applyInputAttributes(this.option(t));break;default:(0,o.Z)((0,l.Z)(i.prototype),"_optionChanged",this).call(this,e)}}},{key:"_resetInputValue",value:function(e){("useForm"!==this.option("uploadMode")||e)&&(this._doPreventInputChange=!0,this._$fileInput.val(""),this._doPreventInputChange=!1)}},{key:"reset",value:function(){this.option("value",[])}}]),i}(b.Z),be=function(){function e(t,i){(0,a.Z)(this,e),this.file=t,this.chunkSize=i,this.index=0}return(0,n.Z)(e,[{key:"read",value:function(){if(!this.file)return null;var e=this.createBlobResult(this.file,this.index,this.chunkSize);return e.isCompleted&&(this.file=null),this.index++,e}},{key:"createBlobResult",value:function(e,t,i){var a=t*i;return{blob:this.sliceFile(e,a,i),index:t,isCompleted:a+i>=e.size}}},{key:"sliceFile",value:function(e,t,i){return e.slice?e.slice(t,t+i):e.webkitSlice?e.webkitSlice(t,t+i):null}}]),e}(),Se=function(){function e(t){(0,a.Z)(this,e),this.fileUploader=t}return(0,n.Z)(e,[{key:"upload",value:function(e){e.isInitialized&&e.isAborted&&this.fileUploader._resetFileState(e),e.isValid()&&!e.uploadStarted&&(this._prepareFileBeforeUpload(e),this._uploadCore(e))}},{key:"abortUpload",value:function(e){var t=this;if(!(e._isError||e._isLoaded||e.isAborted)&&e.uploadStarted&&(e.isAborted=!0,e.request&&e.request.abort(),this._isCustomCallback("abortUpload"))){var i=this.fileUploader.option("abortUpload"),a=this._createUploadArgument(e),n=null;try{var o=i(e.value,a);n=(0,k.p4)(o)}catch(l){n=(new k.BH).reject(l).promise()}n.done((function(){return e.onAbort.fire()})).fail((function(i){return t._handleFileError(e,i)}))}}},{key:"_beforeSend",value:function(e,t){var i=this._createUploadArgument(t);this.fileUploader._beforeSendAction({request:e,file:t.value,uploadInfo:i}),t.request=e}},{key:"_createUploadArgument",value:function(e){}},{key:"_uploadCore",value:function(e){}},{key:"_isCustomCallback",value:function(e){var t=this.fileUploader.option(e);return t&&(0,f.mf)(t)}},{key:"_handleProgress",value:function(e,t){e._isError||(e._isProgressStarted=!0,this._handleProgressCore(e,t))}},{key:"_handleProgressCore",value:function(e,t){}},{key:"_handleFileError",value:function(e,t){e._isError=!0,e.onError.fire(t)}},{key:"_prepareFileBeforeUpload",value:function(e){var t;e.$file&&(null===(t=e.progressBar)||void 0===t||t.dispose(),this.fileUploader._createFileProgressBar(e));e.isInitialized||(e.onLoadStart.add(this._onUploadStarted.bind(this,e)),e.onLoad.add(this._onLoadedHandler.bind(this,e)),e.onError.add(this._onErrorHandler.bind(this,e)),e.onAbort.add(this._onAbortHandler.bind(this,e)),e.onProgress.add(this._onProgressHandler.bind(this,e)),e.isInitialized=!0)}},{key:"_shouldHandleError",value:function(e,t){return(this._isStatusError(t.status)||!e._isProgressStarted)&&!e.isAborted}},{key:"_isStatusError",value:function(e){return 400<=e&&e<500||500<=e&&e<600}},{key:"_onUploadStarted",value:function(e,t){e.uploadStarted=!0,this.fileUploader._uploadStartedAction({file:e.value,event:t,request:e.request})}},{key:"_onAbortHandler",value:function(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader._getUploadAbortedStatusMessage()};this.fileUploader._uploadAbortedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onErrorHandler",value:function(e,t){var i={file:e.value,event:void 0,request:e.request,error:t,message:this.fileUploader.option("uploadFailedMessage")};this.fileUploader._uploadErrorAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onLoadedHandler",value:function(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader.option("uploadedMessage")};e._isLoaded=!0,this.fileUploader._uploadedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onProgressHandler",value:function(e,t){if(e){var i=this.fileUploader._getTotalFilesSize(),a=this.fileUploader._getTotalLoadedFilesSize(),n=Math.min(t.loaded,e.value.size),o=n-e.loadedSize;e.loadedSize=n,this.fileUploader._updateTotalProgress(i,a+o),this.fileUploader._updateProgressBar(e,this._getLoadedData(n,t.total,o,t))}}},{key:"_getLoadedData",value:function(e,t,i,a){return{loaded:e,total:t,currentSegmentSize:i}}},{key:"_extendFormData",value:function(e){var t=this.fileUploader.option("uploadCustomData");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(0,f.$K)(t[i])&&e.append(i,t[i])}}]),e}(),Ce=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(e){var n;return(0,a.Z)(this,i),n=t.call(this,e),n.chunkSize=n.fileUploader.option("chunkSize"),n}return(0,n.Z)(i,[{key:"_uploadCore",value:function(e){var t=e.value,i={name:t.name,loadedBytes:0,type:t.type,blobReader:new be(t,this.chunkSize),guid:new p.Z,fileSize:t.size,count:Math.ceil(t.size/this.chunkSize),customData:{}};e.chunksData=i,this._sendChunk(e,i)}},{key:"_sendChunk",value:function(e,t){var i=this,a=t.blobReader.read();t.currentChunk=a,a&&this._sendChunkCore(e,t,a).done((function(){e.isAborted||(t.loadedBytes+=a.blob.size,e.onProgress.fire({loaded:t.loadedBytes,total:e.value.size}),a.isCompleted&&e.onLoad.fire(),setTimeout((function(){return i._sendChunk(e,t)})))})).fail((function(t){i._shouldHandleError(e,t)&&i._handleFileError(e,t)}))}},{key:"_sendChunkCore",value:function(e,t,i){}},{key:"_tryRaiseStartLoad",value:function(e){e.isStartLoad||(e.isStartLoad=!0,e.onLoadStart.fire())}},{key:"_getEvent",value:function(e){return null}},{key:"_createUploadArgument",value:function(e){return this._createChunksInfo(e.chunksData)}},{key:"_createChunksInfo",value:function(e){return{bytesUploaded:e.loadedBytes,chunkCount:e.count,customData:e.customData,chunkBlob:e.currentChunk.blob,chunkIndex:e.currentChunk.index}}}]),i}(Se),Ze=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_sendChunkCore",value:function(e,t,i){var a=this;return F.Z.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:function(t){return a._beforeSend(t,e)},upload:{onprogress:function(t){return a._handleProgress(e,t)},onloadstart:function(){return a._tryRaiseStartLoad(e)},onabort:function(){return e.onAbort.fire()}},data:this._createFormData({fileName:t.name,blobName:this.fileUploader.option("name"),blob:i.blob,index:i.index,count:t.count,type:t.type,guid:t.guid,size:t.fileSize})})}},{key:"_createFormData",value:function(e){var t=new K.FormData;return t.append(e.blobName,e.blob),t.append(ye,JSON.stringify({FileName:e.fileName,Index:e.index,TotalCount:e.count,FileSize:e.size,FileType:e.type,FileGuid:e.guid})),this._extendFormData(t),t}}]),i}(Ce),xe=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_sendChunkCore",value:function(e,t){this._tryRaiseStartLoad(e);var i=this._createChunksInfo(t),a=this.fileUploader.option("uploadChunk");try{var n=a(e.value,i);return(0,k.p4)(n)}catch(o){return(new k.BH).reject(o).promise()}}},{key:"_shouldHandleError",value:function(e,t){return!0}}]),i}(Ce),Ee=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_uploadCore",value:function(e){var t=this;e.loadedSize=0,this._uploadFile(e).done((function(){e.isAborted||e.onLoad.fire()})).fail((function(i){t._shouldHandleError(e,i)&&t._handleFileError(e,i)}))}},{key:"_uploadFile",value:function(e){}},{key:"_handleProgressCore",value:function(e,t){e.onProgress.fire(t)}},{key:"_getLoadedData",value:function(e,t,a,n){var s=(0,o.Z)((0,l.Z)(i.prototype),"_getLoadedData",this).call(this,e,t,a,n);return s.event=n,s}}]),i}(Se),Ue=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_uploadFile",value:function(e){var t=this;return F.Z.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:function(i){return t._beforeSend(i,e)},upload:{onprogress:function(i){return t._handleProgress(e,i)},onloadstart:function(){return e.onLoadStart.fire()},onabort:function(){return e.onAbort.fire()}},data:this._createFormData(this.fileUploader.option("name"),e.value)})}},{key:"_createFormData",value:function(e,t){var i=new K.FormData;return i.append(e,t,t.name),this._extendFormData(i),i}}]),i}(Ee),Be=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,a.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"_uploadFile",value:function(e){var t=this;e.onLoadStart.fire();var i=this.fileUploader.option("uploadFile");try{var a=i(e.value,(function(i){var a={loaded:i,total:e.size};t._handleProgress(e,a)}));return(0,k.p4)(a)}catch(n){return(new k.BH).reject(n).promise()}}},{key:"_shouldHandleError",value:function(e,t){return!0}}]),i}(Ee);(0,_.Z)("dxFileUploader",Fe);const Me=Fe}}]);
//# sourceMappingURL=8417.559202d1.js.map