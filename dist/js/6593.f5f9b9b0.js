"use strict";(self["webpackChunktims_dexon"]=self["webpackChunktims_dexon"]||[]).push([[6593],{95162:(t,a,s)=>{s.d(a,{Z:()=>l});var o=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"app-loading"},[s("div",{staticClass:"box"},[s("hash-loader",{staticClass:"custom-class",attrs:{color:"#1e1450",loading:!0,size:40,sizeUnit:"px"}}),s("h5",{staticClass:"app-name"},[t._v(t._s(t.text))])],1)])},i=[];const e={name:"app-user-logging-in",props:{text:String}},n=e;var r=s(1001),c=(0,r.Z)(n,o,i,!1,null,"7261fb9f",null);const l=c.exports},99986:(t,a,s)=>{s.d(a,{Z:()=>l});var o=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[t._t("default")],2)},i=[];const e={name:"LayoutMain",components:{}},n=e;var r=s(1001),c=(0,r.Z)(n,o,i,!1,null,null,null);const l=c.exports},46593:(t,a,s)=>{s.r(a),s.d(a,{default:()=>v});var o=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"page-wrapper"},[s("div",{staticClass:"page-toolbar"},[s("toolbar",{attrs:{pageSubName:"My Account",isBack:!0}})],1),s("div",{staticClass:"page-content"},[s("div",{staticClass:"form"},[s("div",{staticClass:"page-section-button"},[s("h2",{staticClass:"page-section-label"},[t._v("Personal Informations")]),0==t.isEdit.info?s("v-ons-toolbar-button",{staticClass:"button",on:{click:function(a){return t.BTN_EDIT("info")}}},[s("i",{staticClass:"las la-edit"}),s("span",[t._v("Edit")])]):t._e()],1),s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Name:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.first_name)+" "+t._s(t.user.last_name)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.first_name,expression:"formData.first_name"}],staticStyle:{"border-radius":"6px 0 0 6px","grid-column":"span 1"},attrs:{placeholder:"Firstname"},domProps:{value:t.formData.first_name},on:{input:function(a){a.target.composing||t.$set(t.formData,"first_name",a.target.value)}}}):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.last_name,expression:"formData.last_name"}],staticStyle:{"border-radius":"0 6px 6px 0","border-width":"1px 1px 1px 0","grid-column":"span 1"},attrs:{placeholder:"Lastname"},domProps:{value:t.formData.last_name},on:{input:function(a){a.target.composing||t.$set(t.formData,"last_name",a.target.value)}}}):t._e()]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Role:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.role_desc)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Employee No:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.emp_no)+" ")])]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Email:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.email)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.email,expression:"formData.email"}],attrs:{placeholder:"Email"},domProps:{value:t.formData.email},on:{input:function(a){a.target.composing||t.$set(t.formData,"email",a.target.value)}}}):t._e()]),s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Phone No:")]),0==t.isEdit.info?s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.phone_no)+" ")]):t._e(),1==t.isEdit.info?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.phone_no,expression:"formData.phone_no"}],attrs:{placeholder:"Phone No"},domProps:{value:t.formData.phone_no},on:{input:function(a){a.target.composing||t.$set(t.formData,"phone_no",a.target.value)}}}):t._e()])]),1==t.isEdit.info?s("div",{staticClass:"form-button-container"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"blue",on:{click:function(a){return t.SAVE_EDIT_INFO()}}},[s("label",[t._v("Save")])]),s("button",{staticClass:"grey",on:{click:function(a){return t.BTN_CANCEL()}}},[s("label",[t._v("Cancel")])])])]):t._e()]),s("div",{staticClass:"form"},[s("div",{staticClass:"page-section-button"},[s("h2",{staticClass:"page-section-label"},[t._v("Account Setting")]),0==t.isEdit.account?s("v-ons-toolbar-button",{staticClass:"button",on:{click:function(a){return t.BTN_EDIT("account")}}},[s("i",{staticClass:"las la-edit"}),s("span",[t._v("Edit")])]):t._e()],1),s("div",{staticClass:"form-item-container"},[s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Username:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.user.username)+" ")])]),1==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Old Password:")]),1==t.isEdit.account?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.oldPassword,expression:"formData.oldPassword"}],attrs:{placeholder:"Old Password",type:"password"},domProps:{value:t.formData.oldPassword},on:{input:function(a){a.target.composing||t.$set(t.formData,"oldPassword",a.target.value)}}}):t._e()]):t._e(),0==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Password:")]),s("p",{staticClass:"info"},[t._v(" "+t._s(t.invisiblePassword)+" ")])]):t._e(),1==t.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("New Password:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.newPassword,expression:"formData.newPassword"}],attrs:{placeholder:"New Password",type:"password"},domProps:{value:t.formData.newPassword},on:{input:function(a){a.target.composing||t.$set(t.formData,"newPassword",a.target.value)}}})]):t._e(),t.formData.newPassword&&1==this.isEdit.account?s("div",{staticClass:"input-set"},[s("p",{staticClass:"label"},[t._v("Confirm Password:")]),1==t.isEdit.account?s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.confirmPassword,expression:"formData.confirmPassword"}],attrs:{placeholder:"Confirm Password",type:"password"},domProps:{value:t.formData.confirmPassword},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.SAVE_EDIT_ACCOUNT()},input:function(a){a.target.composing||t.$set(t.formData,"confirmPassword",a.target.value)}}}):t._e()]):t._e()]),1==t.isEdit.account?s("div",{staticClass:"form-button-container"},[s("div",{staticClass:"button-set"},[s("button",{staticClass:"blue",on:{click:function(a){return t.SAVE_EDIT_ACCOUNT()}}},[s("label",[t._v("Save")])]),s("button",{staticClass:"grey",on:{click:function(a){return t.BTN_CANCEL()}}},[s("label",[t._v("Cancel")])])])]):t._e()])]),1==t.isLoading?s("PageLoading",{attrs:{text:"Loading"}}):t._e()],1)},i=[],e=(s(32564),s(41539),s(89584)),n=s(45549),r=s(39477),c=s(99986),l=s(95162),d=s(62721);const u={name:"AccountView",components:{PageLoading:l.Z,toolbar:d.Z},data:function(){return{user:"",formData:"",invisiblePassword:"********",isEdit:{info:!1,account:!1,photo:!1},picUpload:"",isLoading:!1}},created:function(){this.$emit("update:layout",c.Z),this.$store.commit("CLEAR_CURRENT_CLIENT"),this.$store.commit("UPDATE_CURRENT_INAPP",{name:"My Account",icon:""}),1==this.$store.state.status.server&&this.FETCH_USER_INFO()},mounted:function(){},methods:{FETCH_USER_INFO:function(){var t=this;this.isLoading=!0,setTimeout((function(){var a=JSON.parse(localStorage.getItem("user")).id_account;(0,r.Z)({method:"post",url:"/account-user/get-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_account:a}}).then((function(a){if(200==a.status){var s=a.data[0];t.user=s,console.log("==> Fetch User Info : Account View <==")}}))["catch"]((function(t){console.log(t)}))["finally"]((function(){t.isLoading=!1}))}),500)},UPLOAD_PIC:function(){var t=this;if(console.log("  ==> UPLOAD PIC"),this.picUpload=this.$refs.file.files[0],this.picUpload&&"image/jpeg"==this.picUpload.type||"image/png"==this.picUpload.type)if(this.picUpload.size<2e7)(0,r.Z)({method:"post",url:"/user/upload-pic",headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_user:this.user.id_user,file:this.picUpload}}).then((function(a){console.log("  ==> UPLOAD DONE"),200==a.status&&(t.isEdit.photo=!1,t.$router.go())}))["catch"]((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)}))["finally"]((function(){}));else{this.$ons.notification.alert("File size too large. (20 MB max)");var a=document.getElementById("pic-upload-btn");a.val=""}else{this.$ons.notification.alert("Incorrect filetype. <br/> Only JPEG/PNG file can be uploaded.");var s=document.getElementById("pic-upload-btn");s.val=""}},BTN_EDIT:function(t){var a=this;1==this.isEdit.info||1==this.isEdit.account||1==this.isEdit.photo?this.$ons.notification.confirm("Unsaved changes will be lost.").then((function(s){1==s&&(a.isEdit.info=!1,a.isEdit.account=!1,a.formData=(0,e.Z)(a.user),"info"==t?a.isEdit.info=!0:"account"==t&&(a.isEdit.account=!0))})):(this.formData=(0,e.Z)(this.user),"info"==t?this.isEdit.info=!0:"account"==t?this.isEdit.account=!0:"photo"==t&&(this.isEdit.photo=!0))},BTN_CANCEL:function(){var t=this;this.$ons.notification.confirm("Unsaved changes will be lost.").then((function(a){1==a&&(t.formData={},t.isEdit.info=!1,t.isEdit.account=!1,t.isEdit.photo=!1)}))},SAVE_EDIT_INFO:function(){var t=this;this.$ons.notification.confirm("Confirm Save").then((function(a){if(1==a){var s=t.formData;(0,r.Z)({method:"put",url:"/user/update-info",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:s}).then((function(a){200==a.status&&a.data&&t.$ons.notification.alert("Update user information successful").then((function(a){0==a&&(t.isEdit.user=!1,t.isEdit.info=!1,t.FETCH_USER_INFO())}))}))["catch"]((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)}))["finally"]((function(){}))}}))},SAVE_EDIT_ACCOUNT:function(){var t=this;this.formData.oldPassword?this.formData.newPassword?this.formData.confirmPassword?this.formData.newPassword==this.formData.confirmPassword?(0,n.sha256)(this.formData.oldPassword)==this.user.password?this.$ons.notification.confirm("Confirm Save").then((function(a){1==a&&(0,r.Z)({method:"put",url:"account-user/change-password",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("token"))},data:{id_account:t.formData.id_account,password:(0,n.sha256)(t.formData.confirmPassword)}}).then((function(a){200==a.status&&a.data&&t.$ons.notification.alert("Account password changed").then((function(a){0==a&&(t.isEdit.account=!1,t.FETCH_USER_INFO())}))}))["catch"]((function(a){t.$ons.notification.alert(a.code+" "+a.response.status+" "+a.message)}))["finally"]((function(){}))})):this.$ons.notification.alert("Old password is incorrect."):this.$ons.notification.alert("Confirm password mismatch."):this.$ons.notification.alert('"Confirm Password" field cannot be empty.'):this.$ons.notification.alert('"Password" field cannot be empty.'):this.$ons.notification.alert('"Old Password" field cannot be empty.')}},computed:{baseURL:function(){var t=this.$store.state.mode;return"dev"==t?this.$store.state.modeURL.dev:"prod"==t?this.$store.state.modeURL.prod:console.log("develpment mode set up incorrect.")}}},f=u;var m=s(1001),p=(0,m.Z)(f,o,i,!1,null,"0256e0e1",null);const v=p.exports}}]);
//# sourceMappingURL=6593.f5f9b9b0.js.map